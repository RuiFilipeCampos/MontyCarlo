<!DOCTYPE html>
<!-- Generated by Cython 0.29.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: CSG.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.21</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="CSG.cpp">CSG.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="c">#distutils: language = c++</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="cp">DEF</span> <span class="n">VERBOSE</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="cp">DEF</span> <span class="n">VERBOSE_TALLY</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="cp">DEF</span> <span class="n">DEBUG_MODE</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="k">from</span> <span class="nn">libcpp.vector</span> <span class="k">cimport</span> <span class="n">vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="k">from</span> <span class="nn">libcpp.list</span> <span class="k">cimport</span> <span class="nb">list</span> <span class="k">as</span> <span class="n">cpplist</span><span class="p">;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;IntervalArithmetics.cpp&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: 	<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;IntervalArithmetics.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0015</span>: 	<span class="k">cdef</span> <span class="kt">cppclass</span> <span class="nf">Interval</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>: 		<span class="n">double</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: 		<span class="n">Interval</span><span class="p">();</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>: 		<span class="n">Interval</span><span class="p">(</span><span class="n">double</span> <span class="n">t1</span><span class="p">,</span> <span class="n">double</span> <span class="n">t2</span><span class="p">);</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: 	<span class="k">ctypedef</span> <span class="n">cpplist</span><span class="p">[</span><span class="n">Interval</span><span class="p">]</span> <span class="n">intLIST</span><span class="p">;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: 	<span class="n">intLIST</span> <span class="n">intIntersect</span><span class="p">(</span><span class="n">intLIST</span><span class="o">&amp;</span> <span class="n">left</span><span class="p">,</span> <span class="n">intLIST</span><span class="o">&amp;</span> <span class="n">right</span><span class="p">);</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: 	<span class="n">intLIST</span> <span class="n">intPlus</span><span class="p">(</span><span class="n">intLIST</span><span class="o">&amp;</span> <span class="n">left</span><span class="p">,</span> <span class="n">intLIST</span><span class="o">&amp;</span> <span class="n">right</span><span class="p">);</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: 	<span class="n">intLIST</span> <span class="n">intMinus</span><span class="p">(</span><span class="n">intLIST</span><span class="o">&amp;</span> <span class="n">left</span><span class="p">,</span> <span class="n">intLIST</span><span class="o">&amp;</span> <span class="n">right</span><span class="p">);</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: 	<span class="k">cdef</span> <span class="kt">cppclass</span> <span class="nf">intIterator</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: 		<span class="n">intIterator</span><span class="p">();</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: 		<span class="n">intIterator</span><span class="p">(</span><span class="n">intLIST</span> <span class="n">crosses</span><span class="p">);</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: 		<span class="n">void</span> <span class="n">inc</span><span class="p">();</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: 		<span class="n">double</span> <span class="n">deref</span><span class="p">();</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: 		<span class="n">double</span> <span class="n">current</span><span class="p">();</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">cnp</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0035</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: <span class="k">from</span> <span class="nn">libc.string</span> <span class="k">cimport</span> <span class="n">memcpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>: <span class="k">from</span> <span class="nn">cython.operator</span> <span class="k">import</span> <span class="n">dereference</span> <span class="k">as</span> <span class="n">deref</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: <span class="k">from</span> <span class="nn">cython.operator</span> <span class="k">import</span> <span class="n">preincrement</span> <span class="k">as</span> <span class="n">inc</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="k">from</span> <span class="nn">.main</span> <span class="k">cimport</span> <span class="n">Volume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="k">from</span> <span class="nn">..particles.particle</span> <span class="k">cimport</span> <span class="n">STATE</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="k">from</span> <span class="nn">numpy.math</span> <span class="k">cimport</span> <span class="n">INFINITY</span> <span class="k">as</span> <span class="n">INF</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: <span class="k">from</span> <span class="nn">libcpp.deque</span> <span class="k">cimport</span> <span class="n">deque</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">malloc</span><span class="p">,</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0054</span>: <span class="k">import</span> <span class="nn">sdf</span> <span class="k">as</span> <span class="nn">plt_geo</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sdf, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_plt_geo, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0055</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0056</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">;</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_nan);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_10MontyCarlo_8geometry_3CSG_nan = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0057</span>: <span class="k">ctypedef</span> <span class="n">BVH</span> <span class="n">Vol</span></pre>
<pre class='cython code score-0 '>typedef struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_t_10MontyCarlo_8geometry_3CSG_Vol;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0058</span>: <span class="k">ctypedef</span> <span class="n">BVH</span> <span class="n">V</span></pre>
<pre class='cython code score-0 '>typedef struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_t_10MontyCarlo_8geometry_3CSG_V;
</pre><pre class="cython line score-0">&#xA0;<span class="">0059</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0060</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">eps</span> <span class="o">=</span> <span class="o">.</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_10MontyCarlo_8geometry_3CSG_eps = .1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0061</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>: <span class="k">from</span> <span class="nn">..types</span> <span class="k">cimport</span> <span class="n">double3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>: <span class="c">#cdef class Proxy(CSGvol):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: <span class="c">#	cdef intLIST crosses</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: <span class="c">#	cdef cpplist[Interval] it</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="c">#	cdef void* vol</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: <span class="c">#	cdef double particle_position</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>: <span class="c">#	def __init__(self, vol):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: <span class="c">#		self.vol = &lt;void*&gt; vol</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>: <span class="c">#		self.is_proxy = True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>: <span class="c">#	cdef double localSDF(self, STATE&amp; state):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>: <span class="c">#		self.particle_position += state.last_displacement</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>: <span class="c">#	cdef double SDF(self, double3 pos):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>: <span class="c">#		pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0087</span>: <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span></pre>
<pre class='cython code score-20 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_1lock(PyObject *__pyx_self, PyObject *__pyx_v_msg); /*proto*/
static PyMethodDef __pyx_mdef_10MontyCarlo_8geometry_3CSG_1lock = {"lock", (PyCFunction)__pyx_pw_10MontyCarlo_8geometry_3CSG_1lock, METH_O, 0};
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_1lock(PyObject *__pyx_self, PyObject *__pyx_v_msg) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lock (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_lock(__pyx_self, ((PyObject *)__pyx_v_msg));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_lock(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_msg) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock *__pyx_cur_scope;
  PyObject *__pyx_v__lock = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__3)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lock", 0);
  __pyx_cur_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock *)__pyx_tp_new_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock(__pyx_ptype_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("lock", __pyx_f[0], 87, 0, <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_msg = __pyx_v_msg;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_msg);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_msg);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.lock", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__lock);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__96 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_msg, __pyx_n_s_lock_2, __pyx_n_s_lock_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__96);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__96);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_10MontyCarlo_8geometry_3CSG_1lock, NULL, __pyx_n_s_MontyCarlo_geometry_CSG);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lock, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__3 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_MontyCarlo_geometry_CSG_pyx, __pyx_n_s_lock, 87, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
/* … */
struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock {
  PyObject_HEAD
  PyObject *__pyx_v_msg;
};

</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0088</span>: 	<span class="k">def</span> <span class="nf">_lock</span><span class="p">(</span><span class="n">method</span><span class="p">):</span></pre>
<pre class='cython code score-19 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_4lock_1_lock(PyObject *__pyx_self, PyObject *__pyx_v_method); /*proto*/
static PyMethodDef __pyx_mdef_10MontyCarlo_8geometry_3CSG_4lock_1_lock = {"_lock", (PyCFunction)__pyx_pw_10MontyCarlo_8geometry_3CSG_4lock_1_lock, METH_O, 0};
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_4lock_1_lock(PyObject *__pyx_self, PyObject *__pyx_v_method) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_lock (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_4lock__lock(__pyx_self, ((PyObject *)__pyx_v_method));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_4lock__lock(PyObject *__pyx_self, PyObject *__pyx_v_method) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock *__pyx_cur_scope;
  PyObject *__pyx_v_new_method = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_lock", 0);
  __pyx_cur_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock *)__pyx_tp_new_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock(__pyx_ptype_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("_lock", __pyx_f[0], 88, 0, <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_method = __pyx_v_method;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_method);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_method);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.lock._lock", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_method);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_method, __pyx_n_s_new_method, __pyx_n_s_new_method);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10MontyCarlo_8geometry_3CSG_4lock_1_lock, 0, __pyx_n_s_lock_locals__lock, ((PyObject*)__pyx_cur_scope), __pyx_n_s_MontyCarlo_geometry_CSG, __pyx_d, ((PyObject *)__pyx_codeobj__5));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v__lock = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__5 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__4, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_MontyCarlo_geometry_CSG_pyx, __pyx_n_s_lock_2, 88, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__5)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
/* … */
struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock {
  PyObject_HEAD
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct__lock *__pyx_outer_scope;
  PyObject *__pyx_v_method;
};

</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0089</span>: 		<span class="k">def</span> <span class="nf">new_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre>
<pre class='cython code score-51 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_4lock_5_lock_1new_method(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_10MontyCarlo_8geometry_3CSG_4lock_5_lock_1new_method = {"new_method", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_10MontyCarlo_8geometry_3CSG_4lock_5_lock_1new_method, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_4lock_5_lock_1new_method(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("new_method (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 1) {
    __pyx_v_args = <span class='py_c_api'>PyTuple_GetSlice</span>(__pyx_args, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args));
    if (unlikely(!__pyx_v_args)) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
      <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
      return NULL;
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_args);
  } else {
    __pyx_v_args = __pyx_empty_tuple; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  }
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        default:
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t used_pos_args = (pos_args &lt; 1) ? pos_args : 1;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, "new_method") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 89, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &lt; 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_self = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("new_method", 0, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 89, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args); __pyx_v_args = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.lock._lock.new_method", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_4lock_5_lock_new_method(__pyx_self, __pyx_v_self, __pyx_v_args, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_4lock_5_lock_new_method(PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock *__pyx_cur_scope;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("new_method", 0);
  __pyx_outer_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_1__lock *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("new_method", __pyx_f[0], 89, 0, <span class='error_goto'>__PYX_ERR(0, 89, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.lock._lock.new_method", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_self, __pyx_n_s_args, __pyx_n_s_kwargs);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10MontyCarlo_8geometry_3CSG_4lock_5_lock_1new_method, 0, __pyx_n_s_lock_locals__lock_locals_new_met, ((PyObject*)__pyx_cur_scope), __pyx_n_s_MontyCarlo_geometry_CSG, __pyx_d, ((PyObject *)__pyx_codeobj__2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_new_method = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__2 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_MontyCarlo_geometry_CSG_pyx, __pyx_n_s_new_method, 89, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>: 			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_lock);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 90, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0091</span>: 				<span class="k">raise</span> <span class="ne">RuntimeWarning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_msg)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("msg"); <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span> }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_RuntimeWarning, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_msg);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0092</span>: 			<span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_method)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("method"); <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_self);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_args);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_method, __pyx_t_3, __pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0093</span>: 		<span class="k">return</span> <span class="n">new_method</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_method);
  __pyx_r = __pyx_v_new_method;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0094</span>: 	<span class="k">return</span> <span class="n">_lock</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v__lock);
  __pyx_r = __pyx_v__lock;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0095</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0105</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0106</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0107</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">BVH</span><span class="p">(</span><span class="n">Volume</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH {
  struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume __pyx_base;
  int Nws;
  PyObject *tmp_ws;
  void **ws;
  void **original_ws;
  int has_name;
  int i;
  int keep;
  int lock;
  PyObject *name;
  int render;
  double sdf;
  int cache;
  intIterator cross;
  double particle_position;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_4main_Volume __pyx_base;
  PyObject *(*setOuter)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *, int, int __pyx_skip_dispatch);
  void (*depositDISCRETE)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  double (*main_intersect)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void (*localSDF)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void *(*searchO)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_BVH;

</pre><pre class="cython line score-0">&#xA0;<span class="">0108</span>: 	<span class="c"># Workspace</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>: 	<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">Nws</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>: 	<span class="k">cdef</span> <span class="kt">list</span> <span class="nf">tmp_ws</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>: 	<span class="k">cdef</span> <span class="kt">void</span>** <span class="nf">ws</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: 	<span class="k">cdef</span> <span class="kt">void</span>** <span class="nf">original_ws</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">has_name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>: 	<span class="c"># Boundary Crossing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: 	<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span>                       <span class="c">#position in outers work space</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">keep</span>                   <span class="c">#which intersected volume will keep its intersections cached for the next iteration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>: 	<span class="c"># user related</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">lock</span> 					<span class="c">#prevent user from modifying volume after exit code</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0122</span>: 	<span class="k">cdef</span> <span class="kt">str</span> <span class="nf">name</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0123</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">render</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>: 	<span class="c"># ray marching</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">sdf</span>                  <span class="c"># nearest distance to this volumes surface</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>: 	<span class="c"># Ray Tracing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">cache</span>                  <span class="c"># is this volume storing cached intersections?</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: 	<span class="k">cdef</span> <span class="kt">intIterator</span> <span class="nf">cross</span>           <span class="c"># custom c++ iterator for aiding in simulation with cached intersections</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="kt">particle_position</span>;   # <span class="kt">must</span> <span class="kt">keep</span> <span class="kt">track</span> <span class="kt">of</span> <span class="kt">particles</span> <span class="kt">position</span> <span class="kt">along</span> <span class="kt">the</span> <span class="nf">ray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0136</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 136, 0, <span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0137</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;cache = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0138</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;lock = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0139</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>: 	<span class="c">#@lock(&quot;Context has been opened more than once.&quot;)</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0143</span>: 	<span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_3__enter__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_3__enter__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__enter__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_2__enter__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_2__enter__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__enter__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__enter__", __pyx_f[0], 143, 0, <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__enter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0144</span>: 		<span class="c"># Workspace</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0145</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">Nws</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;Nws = 1;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0146</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tmp_ws</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;tmp_ws);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;tmp_ws);
  __pyx_v_self-&gt;tmp_ws = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0147</span>: 		<span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0148</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0149</span>: 	<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">render</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_5configure(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_5configure(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_render = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("configure (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_render,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_True);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_render);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "configure") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = values[0];
    __pyx_v_render = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("configure", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.configure", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_4configure(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self), __pyx_v_name, __pyx_v_render);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_4configure(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, PyObject *__pyx_v_name, PyObject *__pyx_v_render) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("configure", 0);
  <span class='trace'>__Pyx_TraceCall</span>("configure", __pyx_f[0], 149, 0, <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.configure", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0150</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span></pre>
<pre class='cython code score-12 '>  if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_v_name))||((__pyx_v_name) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_v_name)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_v_name;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;name);
  __pyx_v_self-&gt;name = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0151</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">render</span> <span class="o">=</span> <span class="n">render</span></pre>
<pre class='cython code score-7 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_render); if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  __pyx_v_self-&gt;render = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0152</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>: 	<span class="c"># Constructing BVH</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>: 	<span class="c">#@lock(&quot;Modifiying volume after being closed&quot;)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0155</span>: 	<span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_7__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_7__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__contains__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_6__contains__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_6__contains__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, PyObject *__pyx_v_other) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__contains__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__contains__", __pyx_f[0], 155, 0, <span class='error_goto'>__PYX_ERR(0, 155, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__contains__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0156</span>: 		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BVH</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_other, __pyx_ptype_10MontyCarlo_8geometry_3CSG_BVH); 
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0157</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">tmp_ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    if (unlikely(__pyx_v_self-&gt;tmp_ws == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
      <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_self-&gt;tmp_ws, __pyx_v_other);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 157, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">Nws</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;Nws = (__pyx_v_self-&gt;Nws + 1);
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0159</span>: 			<span class="n">other</span><span class="o">.</span><span class="n">setOuter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp_ws</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-54 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_setOuter);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = __pyx_v_self-&gt;tmp_ws;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    if (unlikely(__pyx_t_6 == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>__PYX_ERR(0, 159, __pyx_L1_error)</span>
    }
    __pyx_t_7 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 159, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_7 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_8, ((PyObject *)__pyx_v_self), __pyx_t_6};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_8, ((PyObject *)__pyx_v_self), __pyx_t_6};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (__pyx_t_8) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, ((PyObject *)__pyx_v_self));
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>: 			<span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">pos</span></pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0163</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_other, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_pos.x = __pyx_t_11;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0164</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_other, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_pos.y = __pyx_t_11;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0165</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_other, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 165, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_pos.z = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self), __pyx_v_pos);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0167</span>: </pre>
<pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>: 	<span class="k">cpdef</span> <span class="nf">setOuter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">BVH</span> <span class="n">other</span><span class="p">,</span> <span class="nb">int</span> <span class="n">index</span><span class="p">):</span></pre>
<pre class='cython code score-92 '>static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_9setOuter(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_setOuter(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_other, int __pyx_v_index, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("setOuter", 0);
  <span class='trace'>__Pyx_TraceCall</span>("setOuter", __pyx_f[0], 168, 0, <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_setOuter);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_9setOuter)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
            __pyx_t_6 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[3] = {__pyx_t_5, ((PyObject *)__pyx_v_other), __pyx_t_3};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[3] = {__pyx_t_5, ((PyObject *)__pyx_v_other), __pyx_t_3};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        {
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          if (__pyx_t_5) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_other));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_other));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, ((PyObject *)__pyx_v_other));
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.setOuter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_9setOuter(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10MontyCarlo_8geometry_3CSG_3BVH_8setOuter[] = "\n\t\tother -&gt; outer volume\n\t\tindex -&gt; self's position in outers workspace\n\t\t";
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_9setOuter(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_other = 0;
  int __pyx_v_index;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("setOuter (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_other,&amp;__pyx_n_s_index,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_other)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("setOuter", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "setOuter") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_other = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)values[0]);
    __pyx_v_index = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_index == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("setOuter", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.setOuter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_other), __pyx_ptype_10MontyCarlo_8geometry_3CSG_BVH, 1, "other", 0))) <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_8setOuter(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self), __pyx_v_other, __pyx_v_index);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_8setOuter(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_other, int __pyx_v_index) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("setOuter", 0);
  <span class='trace'>__Pyx_TraceCall</span>("setOuter (wrapper)", __pyx_f[0], 168, 0, <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_setOuter(__pyx_v_self, __pyx_v_other, __pyx_v_index, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.setOuter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_10MontyCarlo_8geometry_3CSG_3BVH_12generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>: 		<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>: <span class="sd">		other -&gt; outer volume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>: <span class="sd">		index -&gt; self&#39;s position in outers workspace</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>: <span class="sd">		&quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">outer</span> <span class="o">=</span> <span class="n">other</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_other));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_other));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.outer);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.outer));
  __pyx_v_self-&gt;__pyx_base.outer = ((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_other);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">index</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;i = __pyx_v_index;
</pre><pre class="cython line score-0">&#xA0;<span class="">0175</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>: 	<span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_11__iter__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_11__iter__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_10__iter__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_10__iter__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_2___iter__ *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__", 0);
  __pyx_cur_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_2___iter__ *)__pyx_tp_new_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_2___iter__(__pyx_ptype_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_2___iter__, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_2___iter__ *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  {
    __pyx_CoroutineObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_coroutine_body_t) __pyx_gb_10MontyCarlo_8geometry_3CSG_3BVH_12generator, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_BVH___iter, __pyx_n_s_MontyCarlo_geometry_CSG);<span class='error_goto'> if (unlikely(!gen)) __PYX_ERR(0, 176, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_gb_10MontyCarlo_8geometry_3CSG_3BVH_12generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__", 0);
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 176, __pyx_L1_error)</span>
/* … */
  /* function exit code */
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r); __pyx_r = 0;
  #if !CYTHON_USE_EXC_INFO_STACK
  <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
  #endif
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Coroutine_clear</span>((PyObject*)__pyx_generator);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_2___iter__ {
  PyObject_HEAD
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self;
};

</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0177</span>: 		<span class="k">yield</span> <span class="k">from</span> <span class="nn">self.tmp_ws</span><span class="p">[</span><span class="mf">1</span><span class="p">:]</span></pre>
<pre class='cython code score-21 '>  if (unlikely(__pyx_cur_scope-&gt;__pyx_v_self-&gt;tmp_ws == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyList_GetSlice</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;tmp_ws, 1, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = <span class='pyx_c_api'>__Pyx_Generator_Yield_From</span>(__pyx_generator, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_r);
  if (likely(__pyx_r)) {
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
    <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
    /* return from generator, yielding value */
    __pyx_generator-&gt;resume_label = 1;
    return __pyx_r;
    __pyx_L4_resume_from_yield_from:;
    if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
  } else {
    PyObject* exc_type = <span class='pyx_c_api'>__Pyx_PyErr_Occurred</span>();
    if (exc_type) {
      if (likely(exc_type == PyExc_StopIteration || (exc_type != PyExc_GeneratorExit &amp;&amp; <span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration)))) <span class='py_c_api'>PyErr_Clear</span>();
      else <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
    }
  }
  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
</pre><pre class="cython line score-0">&#xA0;<span class="">0178</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0179</span>: 	<span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static Py_ssize_t __pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_14__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_14__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_13__len__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static Py_ssize_t __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_13__len__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__len__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__len__", __pyx_f[0], 179, 0, <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__len__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0180</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nws</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_self-&gt;Nws;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0181</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>: 	<span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">name</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_16set_name(PyObject *__pyx_v_self, PyObject *__pyx_v_name); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_16set_name(PyObject *__pyx_v_self, PyObject *__pyx_v_name) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_name (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_15set_name(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self), ((PyObject*)__pyx_v_name));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_15set_name(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, PyObject *__pyx_v_name) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_name", 0);
  <span class='trace'>__Pyx_TraceCall</span>("set_name", __pyx_f[0], 182, 0, <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.set_name", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0183</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;name);
  __pyx_v_self-&gt;name = __pyx_v_name;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0184</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">has_name</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;has_name = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0187</span>: 	<span class="c"># Exit Code</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>: 	<span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre>
<pre class='cython code score-19 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_18__exit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_18__exit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_args = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__exit__ (wrapper)", 0);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__exit__", 1))) return NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_17__exit__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self), __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_17__exit__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_args, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *__pyx_cur_scope;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_region = 0;
  int __pyx_v_i;
  PyObject *__pyx_v_this = 0;
  PyObject *__pyx_v_generator = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_os = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__exit__", 0);
  __pyx_cur_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *)__pyx_tp_new_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__(__pyx_ptype_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("__exit__", __pyx_f[0], 188, 0, <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__exit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_region);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_this);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_generator);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_os);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ {
  PyObject_HEAD
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self;
};

</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;lock = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0190</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0191</span>: 		<span class="k">cdef</span> <span class="kt">BVH</span> <span class="nf">region</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0193</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0194</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">void</span><span class="o">**&gt;</span> <span class="n">malloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">void</span><span class="o">*</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;ws = ((void **)malloc((__pyx_cur_scope-&gt;__pyx_v_self-&gt;Nws * (sizeof(void *)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0195</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0196</span>: 		<span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp_ws</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_cur_scope-&gt;__pyx_v_self-&gt;tmp_ws) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0197</span>: 		<span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;Nws);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0198</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0199</span>: 		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">region</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tmp_ws</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>  __pyx_t_2 = 0;
  __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_v_self-&gt;tmp_ws; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_10MontyCarlo_8geometry_3CSG_BVH))))) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_region, ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_t_4));
    __pyx_t_4 = 0;
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = (__pyx_t_2 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0200</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>          <span class="o">=</span> <span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span> <span class="n">region</span></pre>
<pre class='cython code score-0 '>    (__pyx_cur_scope-&gt;__pyx_v_self-&gt;ws[__pyx_v_i]) = ((void *)__pyx_v_region);
</pre><pre class="cython line score-0">&#xA0;<span class="">0201</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0202</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_cur_scope-&gt;__pyx_v_self-&gt;render != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0203</span>: 			<span class="nd">@plt_geo</span><span class="o">.</span><span class="n">sdf3</span></pre>
<pre class='cython code score-5 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_plt_geo);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sdf3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0204</span>: 			<span class="k">def</span> <span class="nf">this</span><span class="p">():</span></pre>
<pre class='cython code score-30 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___1this(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___1this = {"this", (PyCFunction)__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___1this, METH_NOARGS, 0};
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___1this(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("this (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___this(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___this(PyObject *__pyx_self) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *__pyx_cur_scope;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *__pyx_outer_scope;
  PyObject *__pyx_v_SDF = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("this", 0);
  __pyx_outer_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("this", __pyx_f[0], 204, 0, <span class='error_goto'>__PYX_ERR(0, 204, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__exit__.this", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_SDF);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_SDF, __pyx_n_s_SDF);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
/* … */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___1this, 0, __pyx_n_s_exit___locals_this, ((PyObject*)__pyx_cur_scope), __pyx_n_s_MontyCarlo_geometry_CSG, __pyx_d, ((PyObject *)__pyx_codeobj__9));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_this = __pyx_t_1;
    __pyx_t_1 = 0;
  __pyx_codeobj__9 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__8, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_MontyCarlo_geometry_CSG_pyx, __pyx_n_s_this, 204, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>: 				<span class="k">def</span> <span class="nf">SDF</span><span class="p">(</span><span class="n">double</span><span class="p">[:,:]</span> <span class="n">P</span><span class="p">):</span></pre>
<pre class='cython code score-22 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___4this_1SDF(PyObject *__pyx_self, PyObject *__pyx_arg_P); /*proto*/
static PyMethodDef __pyx_mdef_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___4this_1SDF = {"SDF", (PyCFunction)__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___4this_1SDF, METH_O, 0};
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___4this_1SDF(PyObject *__pyx_self, PyObject *__pyx_arg_P) {
  __Pyx_memviewslice __pyx_v_P = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF (wrapper)", 0);
  assert(__pyx_arg_P); {
    __pyx_v_P = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_arg_P, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_P.memview)) __PYX_ERR(0, 205, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__exit__.this.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___4this_SDF(__pyx_self, __pyx_v_P);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___4this_SDF(PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_P) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *__pyx_cur_scope;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *__pyx_outer_scope;
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_p;
  int __pyx_v_N;
  PyArrayObject *__pyx_v_sd = 0;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  __pyx_outer_scope = (struct __pyx_obj_10MontyCarlo_8geometry_3CSG___pyx_scope_struct_3___exit__ *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 205, 0, <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.__exit__.this.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_P, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_sd);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_P, __pyx_n_s_P, __pyx_n_s_p, __pyx_n_s_N, __pyx_n_s_sd, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10MontyCarlo_8geometry_3CSG_3BVH_8__exit___4this_1SDF, 0, __pyx_n_s_exit___locals_this_locals_SDF, ((PyObject*)__pyx_cur_scope), __pyx_n_s_MontyCarlo_geometry_CSG, __pyx_d, ((PyObject *)__pyx_codeobj__7));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_SDF = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__7 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__6, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_MontyCarlo_geometry_CSG_pyx, __pyx_n_s_SDF, 205, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0206</span>: 					<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">p</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0207</span>: 					<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_P); 
  __pyx_v_N = __pyx_t_1;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>: 					<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
  __pyx_v_sd = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0209</span>: 					<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0210</span>: 					<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_N;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0211</span>: 						<span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_P.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_P.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_P.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_P.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
    }
    __pyx_v_p.x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_P.data + __pyx_t_9 * __pyx_v_P.strides[0]) ) + __pyx_t_10 * __pyx_v_P.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0212</span>: 						<span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_9 = 1;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_P.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_P.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_P.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_P.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
    }
    __pyx_v_p.y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_P.data + __pyx_t_10 * __pyx_v_P.strides[0]) ) + __pyx_t_9 * __pyx_v_P.strides[1]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0213</span>: 						<span class="n">p</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 2;
    __pyx_t_11 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_P.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_P.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_P.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_P.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
    }
    __pyx_v_p.z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_P.data + __pyx_t_9 * __pyx_v_P.strides[0]) ) + __pyx_t_10 * __pyx_v_P.strides[1]) )));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0214</span>: 						<span class="n">sd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span> }
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_v_p));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_sd), __pyx_v_i, __pyx_t_2, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0215</span>: 					<span class="k">return</span> <span class="n">sd</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_sd));
  __pyx_r = ((PyObject *)__pyx_v_sd);
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0216</span>: 				<span class="k">return</span> <span class="n">SDF</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_SDF);
  __pyx_r = __pyx_v_SDF;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0217</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0218</span>: 			<span class="n">generator</span> <span class="o">=</span> <span class="n">this</span><span class="p">()</span></pre>
<pre class='cython code score-17 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_this);
    __pyx_t_6 = __pyx_v_this; __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_1 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_generator = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0219</span>: 			<span class="k">import</span> <span class="nn">os</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_os, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_os = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0220</span>: 			<span class="n">generator</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;geo/{self.name}.stl&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_generator, __pyx_n_s_save);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = 0;
    __pyx_t_8 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_geo);
    __pyx_t_3 += 4;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_geo);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_geo);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) &gt; __pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) : __pyx_t_8;
    __pyx_t_3 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_stl);
    __pyx_t_3 += 4;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_stl);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_stl);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 3, __pyx_t_3, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0221</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>: 	<span class="k">def</span> <span class="nf">get_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_20get_mesh(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_20get_mesh(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_mesh (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_19get_mesh(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_19get_mesh(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self) {
  PyObject *__pyx_v_pv = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_mesh", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_mesh", __pyx_f[0], 222, 0, <span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.get_mesh", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pv);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0223</span>: 		<span class="k">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pyvista, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_pv = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>: 		<span class="k">return</span> <span class="n">pv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;geo/{self.name}.stl&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pv, __pyx_n_s_read);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = 0;
  __pyx_t_5 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_geo);
  __pyx_t_4 += 4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_geo);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_geo);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_self-&gt;name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) &gt; __pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) : __pyx_t_5;
  __pyx_t_4 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_6);
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_stl);
  __pyx_t_4 += 4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_stl);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_stl);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0225</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>: 	<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_22plot(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_3BVH_22plot(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("plot (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_21plot(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_3BVH_21plot(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self) {
  PyObject *__pyx_v_pv = NULL;
  PyObject *__pyx_v_mesh = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("plot", 0);
  <span class='trace'>__Pyx_TraceCall</span>("plot", __pyx_f[0], 226, 0, <span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.BVH.plot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mesh);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0227</span>: 		<span class="k">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pyvista, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_pv = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>: 		<span class="n">mesh</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;geo/{self.name}.stl&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pv, __pyx_n_s_read);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = 0;
  __pyx_t_5 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_geo);
  __pyx_t_4 += 4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_geo);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_geo);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_self-&gt;name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) &gt; __pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) : __pyx_t_5;
  __pyx_t_4 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_6);
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_stl);
  __pyx_t_4 += 4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_stl);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_stl);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_mesh = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0229</span>: 		<span class="n">mesh</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_mesh, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0230</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0236</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">SP</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_move(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, CYTHON_UNUSED double __pyx_v_SP) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("move", 0);
  <span class='trace'>__Pyx_TraceCall</span>("move", __pyx_f[0], 236, 0, <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.move", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0237</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;move&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 237, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_move_called_from_its_virtual_in);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class="cython line score-0">&#xA0;<span class="">0238</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0239</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositUNIFORM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">SP</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_depositUNIFORM(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, CYTHON_UNUSED double __pyx_v_SP) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositUNIFORM", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositUNIFORM", __pyx_f[0], 239, 0, <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.depositUNIFORM", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0240</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;depositUNIFORM called from BVH (virtual)&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_depositUNIFORM_called_from_BVH_v);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-0">&#xA0;<span class="">0241</span>: 		<span class="k">print</span><span class="p">(</span><span class="s">&quot;depositUNIFORM called from BVH (virtual)&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0242</span>: 		<span class="k">import</span> <span class="nn">time</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>: 		<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">10</span><span class="n">_000</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0246</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositDISCRETE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_depositDISCRETE(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositDISCRETE", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositDISCRETE", __pyx_f[0], 246, 0, <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.depositDISCRETE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0247</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;depositDISCRETE&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_depositDISCRETE_called_from_its);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-0">&#xA0;<span class="">0248</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0249</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositLOCAL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_depositLOCAL(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, CYTHON_UNUSED double __pyx_v_E) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositLOCAL", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositLOCAL", __pyx_f[0], 249, 0, <span class='error_goto'>__PYX_ERR(0, 249, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.depositLOCAL", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0250</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;depositLOCAL&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 250, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_depositLOCAL_called_from_its_vi);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-0">&#xA0;<span class="">0251</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0252</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositRANDOM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">,</span> <span class="n">double</span> <span class="n">tau</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_depositRANDOM(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, CYTHON_UNUSED double __pyx_v_E, CYTHON_UNUSED double __pyx_v_tau) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositRANDOM", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositRANDOM", __pyx_f[0], 252, 0, <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.depositRANDOM", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0253</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;depositRANDOM&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_depositRANDOM_called_from_its_v);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
</pre><pre class="cython line score-0">&#xA0;<span class="">0254</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0255</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">main_intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_main_intersect(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("main_intersect", __pyx_f[0], 255, 0, <span class='error_goto'>__PYX_ERR(0, 255, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.main_intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0256</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;main_intersect&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 256, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_main_intersect_called_from_its);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
</pre><pre class="cython line score-0">&#xA0;<span class="">0257</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0258</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0259</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">localSDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_localSDF(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("localSDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("localSDF", __pyx_f[0], 259, 0, <span class='error_goto'>__PYX_ERR(0, 259, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.localSDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;localSDF&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_localSDF_called_from_its_virtua);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
</pre><pre class="cython line score-0">&#xA0;<span class="">0261</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0262</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0263</span>: 	<span class="k">cdef</span> <span class="kt">void</span>* <span class="nf">searchO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void *__pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_searchO(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  int __pyx_v_i;
  void *__pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("searchO", 0);
  <span class='trace'>__Pyx_TraceCall</span>("searchO", __pyx_f[0], 263, 0, <span class='error_goto'>__PYX_ERR(0, 263, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.searchO", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0264</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0265</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;Nws;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0267</span>: 			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">state</span><span class="o">.</span><span class="n">current_region</span><span class="p">:</span> <span class="k">continue</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (((__pyx_v_self-&gt;ws[__pyx_v_i]) == __pyx_v_state.current_region) != 0);
    if (__pyx_t_4) {
      goto __pyx_L3_continue;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0268</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0269</span>: 			<span class="k">if</span> <span class="p">(&lt;</span><span class="kt">BVH</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *)((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)(__pyx_v_self-&gt;ws[__pyx_v_i]))-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)(__pyx_v_self-&gt;ws[__pyx_v_i]))), __pyx_v_state.pos) != 0);
    if (__pyx_t_4) {
/* … */
    }
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 270, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 270, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0271</span>: 				<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_r = (__pyx_v_self-&gt;ws[__pyx_v_i]);
      goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0272</span>: 		<span class="k">print</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0273</span>: 		<span class="k">return</span> <span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span> <span class="bp">self</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((void *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0274</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>: 		<span class="c">#for i in range(1, (&lt;BVH&gt; state.current_region).i):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0276</span>: 		<span class="c">#	if (&lt;BVH&gt; self.ws[i]).is_inside(state.pos):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0277</span>: 		<span class="c">#		return self.ws[i]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0278</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0279</span>: 		<span class="c">#for i in range((&lt;BVH&gt; state.current_region).i+1, self.Nws):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0280</span>: 		<span class="c">#	if (&lt;BVH&gt; self.ws[i]).is_inside(state.pos):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0281</span>: 		<span class="c">#		return self.ws[i]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0282</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0283</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_SDF(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 284, 0, <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;SDF&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_SDF_called_from_its_virtual_in);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-0">&#xA0;<span class="">0286</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0287</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_is_inside(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 287, 0, <span class='error_goto'>__PYX_ERR(0, 287, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;is_inside&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_is_inside_called_from_its_virtu);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class="cython line score-0">&#xA0;<span class="">0289</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_3BVH_exit(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *__pyx_v_self) {
  int __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("exit", 0);
  <span class='trace'>__Pyx_TraceCall</span>("exit", __pyx_f[0], 290, 0, <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.BVH.exit", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0291</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;Nws;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0293</span>: 			<span class="c">#if (&lt;BVH&gt; self.ws[i]).keep: continue</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0294</span>: 			<span class="p">(&lt;</span><span class="kt">BVH</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)(__pyx_v_self-&gt;ws[__pyx_v_i]))-&gt;cache = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0295</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0296</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0297</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0300</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0304</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0310</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>: <span class="c">#   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0319</span>: <span class="c">#  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0320</span>: <span class="c">#  ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0321</span>: <span class="c">#  ▐░▌          ▐░▌          ▐░▌          </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0322</span>: <span class="c">#  ▐░▌          ▐░█▄▄▄▄▄▄▄▄▄ ▐░▌ ▄▄▄▄▄▄▄▄ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0323</span>: <span class="c">#  ▐░▌          ▐░░░░░░░░░░░▌▐░▌▐░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0324</span>: <span class="c">#  ▐░▌           ▀▀▀▀▀▀▀▀▀█░▌▐░▌ ▀▀▀▀▀▀█░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0325</span>: <span class="c">#  ▐░▌                    ▐░▌▐░▌       ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0326</span>: <span class="c">#  ▐░█▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>: <span class="c">#  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: <span class="c">#   ▀▀▀▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀▀▀▀▀ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: <span class="c">#                                         </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0332</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">CSGvol</span><span class="p">(</span><span class="n">BVH</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH __pyx_base;
  double global_sdf;
  int i0;
  double E;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH __pyx_base;
  intLIST (*intersect)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_5types_double3 &amp;, struct __pyx_t_10MontyCarlo_5types_double3 &amp;);
  void (*globalSDF)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void (*final)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void (*virtual_event)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;, double);
  int (*intEVENT)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void (*exitINNER_TO_OUTER)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *);
  void (*exitINNER_TO_INNER)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *);
  void (*exitOUTER_TO_INNER)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *);
  void (*boundary_crossing)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_CSGvol;
static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_final(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_virtual_event(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;, double);

</pre><pre class="cython line score-0">&#xA0;<span class="">0333</span>: 	<span class="c"># Ray Marching</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">global_sdf</span>           <span class="c"># nearest distance to nearest surface contained by and including this volumes surface </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: 	<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i0</span>                      <span class="c"># position of closest volume in selfs workspace</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0340</span>: 	<span class="c"># CONSTRUCTING A VOLUME</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0341</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_is_inside(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 341, 0, <span class='error_goto'>__PYX_ERR(0, 341, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0342</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;asdsadsad&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_asdsadsad);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class="cython line score-0">&#xA0;<span class="">0343</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0344</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositUNIFORM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">SP</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_depositUNIFORM(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, CYTHON_UNUSED double __pyx_v_SP) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositUNIFORM", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositUNIFORM", __pyx_f[0], 344, 0, <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.depositUNIFORM", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0345</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0346</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositLOCAL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_depositLOCAL(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, CYTHON_UNUSED double __pyx_v_E) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositLOCAL", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositLOCAL", __pyx_f[0], 347, 0, <span class='error_goto'>__PYX_ERR(0, 347, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.depositLOCAL", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0348</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0351</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 351, 0, <span class='error_goto'>__PYX_ERR(0, 351, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0352</span>: 		<span class="c"># Opening lock, volume can be modified</span></pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0353</span>: 		<span class="nb">super</span><span class="p">(</span><span class="n">CSGvol</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span></pre>
<pre class='cython code score-32 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0354</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0355</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0357</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositRANDOM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">,</span> <span class="n">double</span> <span class="n">tau</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_depositRANDOM(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, CYTHON_UNUSED double __pyx_v_E, CYTHON_UNUSED double __pyx_v_tau) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositRANDOM", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositRANDOM", __pyx_f[0], 357, 0, <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.depositRANDOM", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0358</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0361</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositLocaly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_depositLocaly(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, CYTHON_UNUSED double __pyx_v_E) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositLocaly", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositLocaly", __pyx_f[0], 361, 0, <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.depositLocaly", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0362</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>: 	<span class="c">#@lock(&quot;Modifiying volume after being closed&quot;)</span></pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>: 	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_3rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_3rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_axis = 0;
  CYTHON_UNUSED PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_axis = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_2rotate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self), __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_2rotate(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_axis, CYTHON_UNUSED PyObject *__pyx_v_angle) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rotate", __pyx_f[0], 365, 0, <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0366</span>: 		<span class="k">return</span> <span class="bp">NotImplemented</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_NotImplemented);
  __pyx_r = __pyx_builtin_NotImplemented;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0367</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0368</span>: 	<span class="c">#@lock(&quot;Modifiying volume after being closed&quot;)</span></pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0369</span>: 	<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">displacement</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_5translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_5translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED PyObject *__pyx_v_direction = 0;
  CYTHON_UNUSED PyObject *__pyx_v_displacement = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_direction,&amp;__pyx_n_s_displacement,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_direction)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_displacement)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "translate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_direction = values[0];
    __pyx_v_displacement = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_4translate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self), __pyx_v_direction, __pyx_v_displacement);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_4translate(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_direction, CYTHON_UNUSED PyObject *__pyx_v_displacement) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("translate", __pyx_f[0], 369, 0, <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>: 		<span class="k">return</span> <span class="bp">NotImplemented</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_NotImplemented);
  __pyx_r = __pyx_builtin_NotImplemented;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0371</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0372</span>: 	<span class="c">#@lock(&quot;Modifiying volume after being closed&quot;)</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>: 	<span class="k">def</span> <span class="nf">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_7__or__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_7__or__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__or__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_6__or__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_6__or__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__or__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__or__", __pyx_f[0], 373, 0, <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.__or__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0374</span>: 		<span class="k">return</span> <span class="n">Union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_other);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_other);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_other);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Union), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0375</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0376</span>: 	<span class="c">#@lock(&quot;Modifiying volume after being closed&quot;)</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>: 	<span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_9__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_9__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__add__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_8__add__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_8__add__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__add__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__add__", __pyx_f[0], 377, 0, <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.__add__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0378</span>: 		<span class="k">return</span> <span class="n">Union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_other);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_other);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_other);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Union), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0380</span>: 	<span class="c">#@lock(&quot;Modifiying volume after being closed&quot;)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>: 	<span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">other</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_11__and__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_11__and__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__and__ (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_other), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "other", 0))) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_10__and__(((PyObject *)__pyx_v_self), ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_other));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_10__and__(PyObject *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__and__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__and__", __pyx_f[0], 381, 0, <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.__and__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0382</span>: 		<span class="k">return</span> <span class="n">Intersection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_other));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_other));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_other));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Intersection), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: 	<span class="c">#@lock(&quot;Modifiying volume after being closed&quot;)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0385</span>: 	<span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">other</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_13__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6CSGvol_13__sub__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__sub__ (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_other), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "other", 0))) <span class='error_goto'>__PYX_ERR(0, 385, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_12__sub__(((PyObject *)__pyx_v_self), ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_other));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6CSGvol_12__sub__(PyObject *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__sub__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__sub__", __pyx_f[0], 385, 0, <span class='error_goto'>__PYX_ERR(0, 385, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGvol.__sub__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>: 		<span class="k">return</span> <span class="n">Subtraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_other));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_other));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_other));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Subtraction), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0387</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0389</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_intersect(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 389, 0, <span class='error_goto'>__PYX_ERR(0, 389, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0390</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;.intersect called from virtual&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__22, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 390, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__22 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_intersect_called_from_virtual);<span class='error_goto'> if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 390, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__22);
</pre><pre class="cython line score-0">&#xA0;<span class="">0391</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0394</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_SDF(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 395, 0, <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0396</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;SDF FROM VOL WAS CALLED&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_SDF_FROM_VOL_WAS_CALLED);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
</pre><pre class="cython line score-0">&#xA0;<span class="">0397</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">localSDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_localSDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("localSDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("localSDF", __pyx_f[0], 398, 0, <span class='error_goto'>__PYX_ERR(0, 398, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.localSDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0399</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;__pyx_base.cache != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0401</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0402</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[{self.i}] has cached intersections...&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0403</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[{self.i}].particle_position: {self.particle_position}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;state.last_displacement: {state.last_displacement}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0406</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">particle_position</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">last_displacement</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.particle_position = (__pyx_v_self-&gt;__pyx_base.particle_position + __pyx_v_state.last_displacement);
</pre><pre class="cython line score-0">&#xA0;<span class="">0407</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Updated particle position in Volume[{self.i}]...&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[{self.i}].particle_position: {self.particle_position}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0412</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_position</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.sdf = (__pyx_v_self-&gt;__pyx_base.cross.current() - __pyx_v_self-&gt;__pyx_base.particle_position);
</pre><pre class="cython line score-0">&#xA0;<span class="">0413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Safest distance to Volume[{self.i}]: {self.sdf}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0417</span>: 			<span class="k">return</span></pre>
<pre class='cython code score-0 '>    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0418</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[{self.i}] does not have cached intersections...&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0422</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.sdf = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self), __pyx_v_state.pos);
</pre><pre class="cython line score-0">&#xA0;<span class="">0423</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Safest distance to Volume[{self.i}]: {self.sdf}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0427</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">main_intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_main_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  intLIST __pyx_v_temp;
  CYTHON_UNUSED intIterator __pyx_v_temp2;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("main_intersect", __pyx_f[0], 427, 0, <span class='error_goto'>__PYX_ERR(0, 427, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.main_intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0428</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;MAIN_INTERSECT&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0432</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;__pyx_base.cache != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0433</span>: 			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_position</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_self-&gt;__pyx_base.cross.current() - __pyx_v_self-&gt;__pyx_base.particle_position);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0434</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0435</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">particle_position</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.particle_position = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0436</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0437</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_temp = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self, __pyx_v_state.pos, __pyx_v_state.dire);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0438</span>: 		<span class="k">cdef</span> <span class="kt">intIterator</span> <span class="nf">temp2</span> <span class="o">=</span> <span class="n">intIterator</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_temp2 = intIterator(__pyx_v_temp);
</pre><pre class="cython line score-0">&#xA0;<span class="">0439</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">size</span><span class="p">())</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0444</span>: 			<span class="k">print</span><span class="p">(</span><span class="s">&quot;PRINTING INTERSECTIONS&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0445</span>: 			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">size</span><span class="p">()):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0446</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">temp2</span><span class="o">.</span><span class="n">current</span><span class="p">())</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0447</span>: 				<span class="n">temp2</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0448</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">temp2</span><span class="o">.</span><span class="n">current</span><span class="p">())</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0449</span>: 				<span class="n">temp2</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0450</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">cross</span> <span class="o">=</span> <span class="n">intIterator</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.cross = intIterator(__pyx_v_temp);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.cache = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">current</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_self-&gt;__pyx_base.cross.current();
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0455</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">globalSDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_globalSDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  int __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("globalSDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("globalSDF", __pyx_f[0], 455, 0, <span class='error_goto'>__PYX_ERR(0, 455, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.globalSDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0456</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="s">&quot;-- CALCULATING SAFEST DISTANCE&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;cache[0] = {self.cache}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0460</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;__pyx_base.cache != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0461</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[0] has cached intersections...&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[0].particle_position: {self.particle_position}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;state.last_displacement: {state.last_displacement}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0466</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">particle_position</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">last_displacement</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.particle_position = (__pyx_v_self-&gt;__pyx_base.particle_position + __pyx_v_state.last_displacement);
</pre><pre class="cython line score-0">&#xA0;<span class="">0467</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>: 				<span class="k">print</span><span class="p">(</span><span class="s">&quot;Updated particle position in Volume[0]...&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[0].particle_position: {self.particle_position}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0472</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">current</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_position</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.sdf = (__pyx_v_self-&gt;__pyx_base.cross.current() - __pyx_v_self-&gt;__pyx_base.particle_position);
</pre><pre class="cython line score-0">&#xA0;<span class="">0473</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0474</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0475</span>: 				<span class="k">print</span><span class="p">(</span><span class="s">&quot;Updated particle position in Volume[0]...&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0476</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Safest distance to Volume[0]: {self.sdf}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0477</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0478</span>: 		<span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0479</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0480</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Volume[0] does not have cached intersections...&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0481</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_self-&gt;__pyx_base.sdf = (-((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self), __pyx_v_state.pos));
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>: 				<span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Safest distance to Volume[0]: {self.sdf}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0487</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">i0</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;i0 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0488</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">global_sdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdf</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;__pyx_base.sdf;
  __pyx_v_self-&gt;global_sdf = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0491</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;__pyx_base.Nws;
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 1; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0492</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">localSDF</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;__pyx_base.__pyx_vtab)-&gt;localSDF(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))), __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0493</span>: 			<span class="k">if</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_sdf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf &lt; __pyx_v_self-&gt;global_sdf) != 0);
    if (__pyx_t_1) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0494</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">global_sdf</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf;
      __pyx_v_self-&gt;global_sdf = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0495</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">i0</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      __pyx_v_self-&gt;i0 = __pyx_v_i;
</pre><pre class="cython line score-0">&#xA0;<span class="">0496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;The closest volume is: Volume[{self.i0}] @ {(&lt;V&gt; self.ws[self.i0]).sdf}cm&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0502</span>: 	<span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">final</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_final(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("final", 0);
  <span class='trace'>__Pyx_TraceCall</span>("final", __pyx_f[0], 502, 0, <span class='error_goto'>__PYX_ERR(0, 502, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.final", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0503</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;FINAL DISPLACEMENT: L = {state.L}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0505</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">last_displacement</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_state.L;
  __pyx_v_state.last_displacement = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0506</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0507</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.x = (__pyx_v_state.pos.x + (__pyx_v_state.dire.x * __pyx_v_state.L));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0508</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.y = (__pyx_v_state.pos.y + (__pyx_v_state.dire.y * __pyx_v_state.L));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0509</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.z = (__pyx_v_state.pos.z + (__pyx_v_state.dire.z * __pyx_v_state.L));
</pre><pre class="cython line score-0">&#xA0;<span class="">0510</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0511</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.L = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0512</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>: 			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;is_inside[{i}] = {(&lt;V&gt; self.ws[i]).is_inside(state.pos)}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0519</span>: 	<span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">virtual_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">dr</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_virtual_event(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, double __pyx_v_dr) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("virtual_event", 0);
  <span class='trace'>__Pyx_TraceCall</span>("virtual_event", __pyx_f[0], 519, 0, <span class='error_goto'>__PYX_ERR(0, 519, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.virtual_event", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0520</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;VIRTUAL: dr = {dr}, L = {state.L}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0521</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">last_displacement</span> <span class="o">=</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.last_displacement = __pyx_v_dr;
</pre><pre class="cython line score-0">&#xA0;<span class="">0522</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0524</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;norm of dire:&quot;</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.x = (__pyx_v_state.pos.x + (__pyx_v_state.dire.x * __pyx_v_dr));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.y = (__pyx_v_state.pos.y + (__pyx_v_state.dire.y * __pyx_v_dr));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.z = (__pyx_v_state.pos.z + (__pyx_v_state.dire.z * __pyx_v_dr));
</pre><pre class="cython line score-0">&#xA0;<span class="">0528</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0529</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">L</span> <span class="o">-=</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.L = (__pyx_v_state.L - __pyx_v_dr);
</pre><pre class="cython line score-0">&#xA0;<span class="">0530</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0531</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>: 			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;is_inside[{i}] = {(&lt;V&gt; self.ws[i]).is_inside(state.pos)}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0537</span>: 	<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">intEVENT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_intEVENT(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  void *__pyx_v_vol;
  double __pyx_v_cross;
  double __pyx_v_second_nearest;
  int __pyx_v_i;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intEVENT", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intEVENT", __pyx_f[0], 537, 0, <span class='error_goto'>__PYX_ERR(0, 537, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.intEVENT", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0538</span>: 		<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">		Instruct nearest surface to intersect with the ray defined</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: <span class="sd">		in the particles state:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: <span class="sd">			ray = state.pos + t*ray.dire  for t &gt;= 0</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">		Act according to the number of intersections found:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>: <span class="sd">			0 intersections</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>: <span class="sd">			---------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>: <span class="sd">			Particle hits L before hitting second nearest surface?</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>: <span class="sd">				YES:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>: <span class="sd">					- Perform final displacement event.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>: <span class="sd">				NO: </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>: <span class="sd">					- Perform virtual displacement event;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>: <span class="sd">					- Substitute nearest surface by a point at</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>: <span class="sd">					  infinity.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>: <span class="sd">			N intersections</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>: <span class="sd">			---------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>: <span class="sd">			- insert point at infinity in the intersecions map</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>: <span class="sd">			We have three quantities:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>: <span class="sd">				L: distance to end of step</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>: <span class="sd">				second_nearest: distance to second nearest surface</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>: <span class="sd">				d: distance to intersection</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>: <span class="sd">				if min() == L:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>: <span class="sd">					go to L; end step;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0572</span>: <span class="sd">				elif min() == second_nearest:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0573</span>: <span class="sd">					virtual step</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0574</span>: <span class="sd">					make proxy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0575</span>: <span class="sd">					continue</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0576</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0577</span>: <span class="sd">				elif min() == d:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>: <span class="sd">					go to d, finish loop</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: <span class="sd">		&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="s">&quot;INTERSECTION EVENT&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: 		<span class="c"># get the closest volume, easier to write this way...</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0585</span>: 		<span class="k">cdef</span> <span class="kt">void</span>* <span class="nf">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_vol = (__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_self-&gt;i0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0586</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cross</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="n">vol</span><span class="p">)</span><span class="o">.</span><span class="n">main_intersect</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_cross = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_vol)-&gt;__pyx_base.__pyx_vtab)-&gt;main_intersect(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_vol)), __pyx_v_state);
</pre><pre class="cython line score-0">&#xA0;<span class="">0587</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>: 		<span class="c"># look for distance to the second nearest surface</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0591</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">second_nearest</span> <span class="o">=</span> <span class="n">INF</span></pre>
<pre class='cython code score-0 '>  __pyx_v_second_nearest = NPY_INFINITY;
</pre><pre class="cython line score-0">&#xA0;<span class="">0592</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0594</span>: 		<span class="k">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = __pyx_convert__to_py_struct____pyx_t_10MontyCarlo_5types_double3(__pyx_v_state.pos);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 594, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 594, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0595</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0596</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">i0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;i0;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0597</span>: 			<span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span><span class="p">,</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span></pre>
<pre class='cython code score-19 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i])));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, ((PyObject *)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i])));
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 597, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0598</span>: 			<span class="k">if</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span> <span class="o">&lt;</span> <span class="n">second_nearest</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = ((((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf &lt; __pyx_v_second_nearest) != 0);
    if (__pyx_t_7) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0599</span>: 				<span class="n">second_nearest</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf;
      __pyx_v_second_nearest = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">0600</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0601</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i0</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;__pyx_base.Nws;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = (__pyx_v_self-&gt;i0 + 1); __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0602</span>: 			<span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span><span class="p">,</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span></pre>
<pre class='cython code score-19 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 602, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 602, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 602, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i])));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i])));
    __pyx_t_6 = 0;
    __pyx_t_5 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 602, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0603</span>: 			<span class="k">if</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span> <span class="o">&lt;</span> <span class="n">second_nearest</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = ((((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf &lt; __pyx_v_second_nearest) != 0);
    if (__pyx_t_7) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0604</span>: 				<span class="n">second_nearest</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">sdf</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;sdf;
      __pyx_v_second_nearest = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">0605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;cross = {cross} | second_nearest = {second_nearest}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0610</span>: 		<span class="c"># no intersections found</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0611</span>: 		<span class="k">if</span> <span class="n">cross</span> <span class="o">==</span> <span class="n">INF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_cross == NPY_INFINITY) != 0);
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0612</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;no intersections found&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>: 			<span class="c"># min() = L</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0614</span>: 			<span class="k">if</span> <span class="n">second_nearest</span> <span class="o">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = ((__pyx_v_second_nearest &gt; __pyx_v_state.L) != 0);
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0615</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.exit(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0617</span>: 				<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_r = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0618</span>: 			<span class="c"># min() = second_nearest</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0619</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">virtual_event</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">second_nearest</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_virtual_event(__pyx_v_self, __pyx_v_state, __pyx_v_second_nearest);
</pre><pre class="cython line score-0">&#xA0;<span class="">0620</span>: 			<span class="c">#self.ws[self.i0] = proxy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>: 			<span class="c">#self.reset = True</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0622</span>: 			<span class="k">return</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0624</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>: 		<span class="k">if</span> <span class="n">cross</span> <span class="o">&lt;</span> <span class="n">second_nearest</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_cross &lt; __pyx_v_second_nearest) != 0);
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0626</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0627</span>: 			<span class="c"># min() == L</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>: 			<span class="k">if</span> <span class="n">cross</span> <span class="o">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = ((__pyx_v_cross &gt; __pyx_v_state.L) != 0);
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0629</span>: 				<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;min() == L&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.exit(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>: 				<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_r = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0633</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0634</span>: 			<span class="c"># min() == it.first </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;particle will definetly hit the surface&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0636</span>: 			<span class="c"># particle will definetly hit the surface</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">virtual_event</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cross</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_virtual_event(__pyx_v_self, __pyx_v_state, __pyx_v_cross);
</pre><pre class="cython line score-0">&#xA0;<span class="">0638</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0639</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;before incrementing: current = {(&lt;V&gt; vol).cross.current()}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0640</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="n">vol</span><span class="p">)</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_vol)-&gt;cross.inc();
</pre><pre class="cython line score-0">&#xA0;<span class="">0641</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;icremented successfully&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;after incrementing: current = {(&lt;V&gt; vol).cross.current()}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0643</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">boundary_crossing</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;boundary_crossing(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0644</span>: 			<span class="k">return</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 2;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0645</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>: 		<span class="c"># min() == L</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0647</span>: 		<span class="k">if</span> <span class="n">second_nearest</span> <span class="o">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_second_nearest &gt; __pyx_v_state.L) != 0);
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0648</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;min() == L 222&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0649</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.exit(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0651</span>: 			<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0652</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0655</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">exitINNER_TO_OUTER</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_exitINNER_TO_OUTER(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self) {
  int __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("exitINNER_TO_OUTER", 0);
  <span class='trace'>__Pyx_TraceCall</span>("exitINNER_TO_OUTER", __pyx_f[0], 655, 0, <span class='error_goto'>__PYX_ERR(0, 655, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.exitINNER_TO_OUTER", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0656</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0657</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.Nws;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0658</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;cache = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0659</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;keep = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0660</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0661</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">exitINNER_TO_INNER</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_exitINNER_TO_INNER(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self) {
  int __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("exitINNER_TO_INNER", 0);
  <span class='trace'>__Pyx_TraceCall</span>("exitINNER_TO_INNER", __pyx_f[0], 662, 0, <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.exitINNER_TO_INNER", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0663</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.Nws;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0665</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;cache = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0666</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;keep = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0667</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">exitOUTER_TO_INNER</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_exitOUTER_TO_INNER(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self) {
  int __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("exitOUTER_TO_INNER", 0);
  <span class='trace'>__Pyx_TraceCall</span>("exitOUTER_TO_INNER", __pyx_f[0], 668, 0, <span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.exitOUTER_TO_INNER", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0669</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.Nws;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0671</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;cache = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0672</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;keep = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0673</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0674</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">boundary_crossing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_boundary_crossing(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("boundary_crossing", 0);
  <span class='trace'>__Pyx_TraceCall</span>("boundary_crossing", __pyx_f[0], 674, 0, <span class='error_goto'>__PYX_ERR(0, 674, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.boundary_crossing", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0675</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>: 		<span class="c"># from inner to somewhere in outer</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0677</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">i0</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;i0 == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0678</span>: 			<span class="n">state</span><span class="o">.</span><span class="n">current_region</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer</span><span class="p">)</span><span class="o">.</span><span class="n">searchO</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_state.current_region = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_self-&gt;__pyx_base.__pyx_base.outer)-&gt;__pyx_base.__pyx_vtab)-&gt;searchO(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_self-&gt;__pyx_base.__pyx_base.outer)), __pyx_v_state);
</pre><pre class="cython line score-0">&#xA0;<span class="">0679</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>: 			<span class="c"># staying in outer, must keep cached intersections</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0681</span>: 			<span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">current_region</span> <span class="o">==</span> <span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_state.current_region == ((void *)__pyx_v_self-&gt;__pyx_base.__pyx_base.outer)) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0682</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_v_self-&gt;__pyx_base.keep = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0683</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">exitINNER_TO_OUTER</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;exitINNER_TO_OUTER(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0684</span>: 				<span class="k">return</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0685</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>: 			<span class="c"># entering some adjacent volume, must intersect it then</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0687</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">current_region</span><span class="p">)</span><span class="o">.</span><span class="n">main_intersect</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    (void)(((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_state.current_region)-&gt;__pyx_base.__pyx_vtab)-&gt;main_intersect(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_state.current_region)), __pyx_v_state));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0688</span>: 			<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">current_region</span><span class="p">)</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_state.current_region)-&gt;keep = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0689</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">exitINNER_TO_INNER</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;exitINNER_TO_INNER(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0690</span>: 			<span class="k">return</span></pre>
<pre class='cython code score-0 '>    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0691</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0692</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0693</span>: 		<span class="c"># from outer to inner</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0694</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">current_region</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">i0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.current_region = (__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_self-&gt;i0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">exitOUTER_TO_INNER</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;exitOUTER_TO_INNER(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>: 		<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">current_region</span><span class="p">)</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_state.current_region)-&gt;keep = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>: 		<span class="p">(&lt;</span><span class="kt">V</span><span class="p">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">current_region</span><span class="p">)</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  ((__pyx_t_10MontyCarlo_8geometry_3CSG_V)__pyx_v_state.current_region)-&gt;cache = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>: 		<span class="k">return</span></pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0699</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0700</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">SP</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_move(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, CYTHON_UNUSED double __pyx_v_SP) {
  int __pyx_v_case;
  int __pyx_v_i;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("move", 0);
  <span class='trace'>__Pyx_TraceCall</span>("move", __pyx_f[0], 701, 0, <span class='error_goto'>__PYX_ERR(0, 701, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGvol.move", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0702</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">case</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s"> ----MOVING PARTICLE----&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;CURRENT_POSITION: {state.pos}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Is inside current region? {(&lt;V&gt; state.current_region).is_inside(state.pos)}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>: 			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;is_inside[{i}] = {(&lt;V&gt; self.ws[i]).is_inside(state.pos)}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0711</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="s">&quot;STARTING EVENT LOOP&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>: 		<span class="k">while</span> <span class="bp">True</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0713</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">globalSDF</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;globalSDF(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0">&#xA0;<span class="">0714</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;The safest distance is {self.global_sdf}cm | Physics proposed {state.L}cm &quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0718</span>: 			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_sdf</span> <span class="o">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_self-&gt;global_sdf &gt; __pyx_v_state.L) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0719</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0">&#xA0;<span class="">0720</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0721</span>: 				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_self-&gt;__pyx_base.Nws;
      __pyx_t_3 = __pyx_t_2;
      for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
        __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0722</span>: 					<span class="p">(&lt;</span><span class="kt">BVH</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">keep</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>        ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;keep = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0723</span>: 					<span class="p">(&lt;</span><span class="kt">BVH</span><span class="p">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>        ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH *)(__pyx_v_self-&gt;__pyx_base.ws[__pyx_v_i]))-&gt;cache = 0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0724</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.exit(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self));
</pre><pre class="cython line score-0">&#xA0;<span class="">0725</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0727</span>: 				<span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>      __pyx_r = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0728</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0729</span>: 			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_sdf</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_self-&gt;global_sdf &lt; __pyx_v_10MontyCarlo_8geometry_3CSG_eps) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0730</span>: 				<span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intEVENT</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_case = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intEVENT(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0">&#xA0;<span class="">0731</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0733</span>: 				<span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span> <span class="c"># boundary crossing</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_case == 2) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0734</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>: 					<span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>        __pyx_r = 1;
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0737</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0738</span>: 				<span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span> <span class="c"># final displacement</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_case == 0) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0739</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0740</span>: 					<span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>        __pyx_r = 0;
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0741</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0742</span>: 				<span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span> <span class="c"># virtual displacement, proxys have been set</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_case == 1) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0743</span>: 					<span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L3_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0744</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">virtual_event</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_sdf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10MontyCarlo_8geometry_3CSG_6CSGvol_virtual_event(__pyx_v_self, __pyx_v_state, __pyx_v_self-&gt;global_sdf);
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0745</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0746</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0751</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0752</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0753</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0755</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0756</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0757</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0758</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0760</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0763</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0765</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0766</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0767</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0768</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0769</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0771</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0772</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0773</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0774</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0775</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0776</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0778</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0780</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0781</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0782</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0783</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0784</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0789</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0790</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0791</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0795</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0799</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0800</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0801</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0802</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0805</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0806</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0807</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0808</span>: <span class="c">#   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄        ▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄       ▄▄ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>: <span class="c">#  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░▌      ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░▌     ▐░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0810</span>: <span class="c">#   ▀▀▀▀█░█▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░▌░▌     ▐░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░▌░▌   ▐░▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>: <span class="c">#       ▐░▌     ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌▐░▌    ▐░▌▐░▌          ▐░▌          ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌▐░▌ ▐░▌▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>: <span class="c">#       ▐░▌     ▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌▐░▌ ▐░▌   ▐░▌▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄▄▄ ▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄█░▌▐░▌ ▐░▐░▌ ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>: <span class="c">#       ▐░▌     ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌  ▐░▌  ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌       ▐░▌▐░░░░░░░░░░░▌▐░▌  ▐░▌  ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>: <span class="c">#       ▐░▌     ▐░█▀▀▀▀█░█▀▀ ▐░█▀▀▀▀▀▀▀█░▌▐░▌   ▐░▌ ▐░▌ ▀▀▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░▌       ▐░▌▐░█▀▀▀▀█░█▀▀ ▐░▌   ▀   ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: <span class="c">#       ▐░▌     ▐░▌     ▐░▌  ▐░▌       ▐░▌▐░▌    ▐░▌▐░▌          ▐░▌▐░▌          ▐░▌       ▐░▌▐░▌     ▐░▌  ▐░▌       ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>: <span class="c">#       ▐░▌     ▐░▌      ▐░▌ ▐░▌       ▐░▌▐░▌     ▐░▐░▌ ▄▄▄▄▄▄▄▄▄█░▌▐░▌          ▐░█▄▄▄▄▄▄▄█░▌▐░▌      ▐░▌ ▐░▌       ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>: <span class="c">#       ▐░▌     ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌      ▐░░▌▐░░░░░░░░░░░▌▐░▌          ▐░░░░░░░░░░░▌▐░▌       ▐░▌▐░▌       ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>: <span class="c">#        ▀       ▀         ▀  ▀         ▀  ▀        ▀▀  ▀▀▀▀▀▀▀▀▀▀▀  ▀            ▀▀▀▀▀▀▀▀▀▀▀  ▀         ▀  ▀         ▀ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0822</span>: <span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">new_rotationT</span><span class="p">(</span><span class="n">_axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>static PyArrayObject *__pyx_f_10MontyCarlo_8geometry_3CSG_new_rotationT(PyObject *__pyx_v__axis, PyObject *__pyx_v_angle) {
  PyArrayObject *__pyx_v_axis = 0;
  double __pyx_v_ux;
  double __pyx_v_uy;
  double __pyx_v_uz;
  PyArrayObject *__pyx_v_T = 0;
  double __pyx_v__cos;
  double __pyx_v_oneMcos;
  double __pyx_v__sin;
  PyArrayObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("new_rotationT", 0);
  <span class='trace'>__Pyx_TraceCall</span>("new_rotationT", __pyx_f[0], 822, 0, <span class='error_goto'>__PYX_ERR(0, 822, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.new_rotationT", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_axis);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_T);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0823</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0824</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">_axis</span><span class="p">)</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 824, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 824, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v__axis) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v__axis);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 824, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 824, __pyx_L1_error)</span>
  __pyx_v_axis = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0825</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0826</span>: 		<span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">**</span><span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Power</span>(((PyObject *)__pyx_v_axis), __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(((PyObject *)__pyx_v_axis), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_axis, ((PyArrayObject *)__pyx_t_2));
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0827</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0828</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">ux</span> <span class="o">=</span> <span class="n">axis</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_axis), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 828, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ux = __pyx_t_7;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0829</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">uy</span> <span class="o">=</span> <span class="n">axis</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_axis), 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 829, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 829, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_uy = __pyx_t_7;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0830</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">uz</span> <span class="o">=</span> <span class="n">axis</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_axis), 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 830, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_7 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 830, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_uz = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">0831</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0833</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">4</span><span class="p">,</span><span class="mf">4</span><span class="p">))</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_tuple__26) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_tuple__26);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 833, __pyx_L1_error)</span>
  __pyx_v_T = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
</pre><pre class="cython line score-0">&#xA0;<span class="">0834</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0835</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">_cos</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_angle); if (unlikely((__pyx_t_7 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 835, __pyx_L1_error)</span>
  __pyx_v__cos = cos(__pyx_t_7);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0836</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">oneMcos</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">_cos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_oneMcos = (1.0 - __pyx_v__cos);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0837</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">_sin</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">_cos</span><span class="o">*</span><span class="n">_cos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v__sin = sqrt((1.0 - (__pyx_v__cos * __pyx_v__cos)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0838</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cos</span> <span class="o">+</span> <span class="n">ux</span><span class="o">*</span><span class="n">ux</span><span class="o">*</span><span class="n">oneMcos</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v__cos + ((__pyx_v_ux * __pyx_v_ux) * __pyx_v_oneMcos)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__27, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 839, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 839, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0840</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ux</span><span class="o">*</span><span class="n">uy</span><span class="o">*</span><span class="n">oneMcos</span> <span class="o">-</span> <span class="n">uz</span><span class="o">*</span><span class="n">_sin</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_ux * __pyx_v_uy) * __pyx_v_oneMcos) - (__pyx_v_uz * __pyx_v__sin)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__28, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ux</span><span class="o">*</span><span class="n">uz</span><span class="o">*</span><span class="n">oneMcos</span> <span class="o">+</span> <span class="n">uy</span><span class="o">*</span><span class="n">_sin</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_ux * __pyx_v_uz) * __pyx_v_oneMcos) + (__pyx_v_uy * __pyx_v__sin)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__29, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 841, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 841, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
</pre><pre class="cython line score-0">&#xA0;<span class="">0842</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0843</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">uy</span><span class="o">*</span><span class="n">ux</span><span class="o">*</span><span class="n">oneMcos</span> <span class="o">+</span> <span class="n">uz</span><span class="o">*</span><span class="n">_sin</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_uy * __pyx_v_ux) * __pyx_v_oneMcos) + (__pyx_v_uz * __pyx_v__sin)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__30, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0844</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cos</span> <span class="o">+</span> <span class="n">uy</span><span class="o">*</span><span class="n">uy</span><span class="o">*</span><span class="n">oneMcos</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v__cos + ((__pyx_v_uy * __pyx_v_uy) * __pyx_v_oneMcos)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__31, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0845</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">uy</span><span class="o">*</span><span class="n">uz</span><span class="o">*</span><span class="n">oneMcos</span> <span class="o">-</span> <span class="n">ux</span><span class="o">*</span><span class="n">_sin</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_uy * __pyx_v_uz) * __pyx_v_oneMcos) - (__pyx_v_ux * __pyx_v__sin)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 845, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__32, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 845, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);
</pre><pre class="cython line score-0">&#xA0;<span class="">0846</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0847</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">uz</span><span class="o">*</span><span class="n">ux</span><span class="o">*</span><span class="n">oneMcos</span><span class="o">-</span><span class="n">uy</span><span class="o">*</span><span class="n">_sin</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_uz * __pyx_v_ux) * __pyx_v_oneMcos) - (__pyx_v_uy * __pyx_v__sin)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__33, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 847, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 847, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0848</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">uz</span><span class="o">*</span><span class="n">uy</span><span class="o">*</span><span class="n">oneMcos</span> <span class="o">+</span> <span class="n">ux</span><span class="o">*</span><span class="n">_sin</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((__pyx_v_uz * __pyx_v_uy) * __pyx_v_oneMcos) + (__pyx_v_ux * __pyx_v__sin)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__34, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0849</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">_cos</span> <span class="o">+</span> <span class="n">uz</span><span class="o">*</span><span class="n">uz</span><span class="o">*</span><span class="n">oneMcos</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v__cos + ((__pyx_v_uz * __pyx_v_uz) * __pyx_v_oneMcos)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__35, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 849, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
</pre><pre class="cython line score-0">&#xA0;<span class="">0850</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0851</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-10 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__36, __pyx_int_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__36 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_3, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__36);
</pre><pre class="cython line score-0">&#xA0;<span class="">0852</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>: 		<span class="k">return</span> <span class="n">T</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_T));
  __pyx_r = __pyx_v_T;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0854</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0855</span>: <span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">Carr_to_NParr</span><span class="p">(</span><span class="n">double</span><span class="o">*</span> <span class="n">arr</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>static PyArrayObject *__pyx_f_10MontyCarlo_8geometry_3CSG_Carr_to_NParr(double *__pyx_v_arr) {
  PyObject *__pyx_v_numbers = NULL;
  int __pyx_v_i;
  PyArrayObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("Carr_to_NParr", 0);
  <span class='trace'>__Pyx_TraceCall</span>("Carr_to_NParr", __pyx_f[0], 855, 0, <span class='error_goto'>__PYX_ERR(0, 855, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Carr_to_NParr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numbers);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0856</span>: 	<span class="n">numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">16</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_int_16) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_int_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 856, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_numbers = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0857</span>: 	<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>: 	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">16</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_4 = 0; __pyx_t_4 &lt; 16; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0859</span>: 		<span class="n">numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_arr[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_numbers, __pyx_v_i, __pyx_t_1, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0860</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0861</span>: 	<span class="n">numbers</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_numbers, __pyx_n_s_shape, __pyx_tuple__26) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L1_error)</span>
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0862</span>: 	<span class="k">return</span> <span class="n">numbers</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(((__pyx_v_numbers) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_numbers, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_numbers);
  __pyx_r = ((PyArrayObject *)__pyx_v_numbers);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0863</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0864</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Transform</span><span class="p">(</span><span class="n">CSGvol</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *primitive;
  double T[16];
  double iT[16];
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
  void (*inv_pos)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *, struct __pyx_t_10MontyCarlo_5types_double3 &amp;);
  void (*inv_dire)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *, struct __pyx_t_10MontyCarlo_5types_double3 &amp;);
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Transform;

</pre><pre class="cython line score-0">&#xA0;<span class="">0865</span>: 	<span class="k">cdef</span> <span class="kt">Primitive</span> <span class="nf">primitive</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>: 	<span class="k">cdef</span> <span class="kt">double</span>[16] <span class="nf">T</span><span class="p">,</span> <span class="nf">iT</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0868</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Primitive</span> <span class="n">primitive</span><span class="p">,</span> <span class="n">cnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">T</span><span class="p">,</span> <span class="n">cnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">iT</span><span class="p">):</span></pre>
<pre class='cython code score-43 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive = 0;
  PyArrayObject *__pyx_v_T = 0;
  PyArrayObject *__pyx_v_iT = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_primitive,&amp;__pyx_n_s_T,&amp;__pyx_n_s_iT,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_primitive)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iT)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_primitive = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)values[0]);
    __pyx_v_T = ((PyArrayObject *)values[1]);
    __pyx_v_iT = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_primitive), __pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive, 1, "primitive", 0))) <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_T), __pyx_ptype_5numpy_ndarray, 1, "T", 0))) <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_iT), __pyx_ptype_5numpy_ndarray, 1, "iT", 0))) <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self), __pyx_v_primitive, __pyx_v_T, __pyx_v_iT);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive, PyArrayObject *__pyx_v_T, PyArrayObject *__pyx_v_iT) {
  int __pyx_v_i;
  double __pyx_v_t;
  double __pyx_v_it;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 868, 0, <span class='error_goto'>__PYX_ERR(0, 868, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0869</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">primitive</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;primitive);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;primitive));
  __pyx_v_self-&gt;primitive = __pyx_v_primitive;
</pre><pre class="cython line score-0">&#xA0;<span class="">0870</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">it</span></pre>
<pre class="cython line score-123" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0873</span>: 		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">iT</span><span class="o">.</span><span class="n">flat</span><span class="p">)):</span></pre>
<pre class='cython code score-123 '>  __pyx_t_1 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_T), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_iT), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_10 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_t = __pyx_t_10;
    __pyx_v_it = __pyx_t_11;
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = (__pyx_t_1 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0874</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;T[__pyx_v_i]) = __pyx_v_t;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0875</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;iT[__pyx_v_i]) = __pyx_v_it;
</pre><pre class="cython line score-0">&#xA0;<span class="">0876</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>: 	<span class="nd">@property</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0878</span>: 	<span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_6matrix_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_6matrix_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_6matrix___get__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_6matrix___get__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 878, 0, <span class='error_goto'>__PYX_ERR(0, 878, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.matrix.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0879</span>: 		<span class="k">return</span> <span class="n">Carr_to_NParr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_Carr_to_NParr(__pyx_v_self-&gt;T));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0880</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>: 	<span class="nd">@property</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0882</span>: 	<span class="k">def</span> <span class="nf">inv_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_10inv_matrix_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_10inv_matrix_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_10inv_matrix___get__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_10inv_matrix___get__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 882, 0, <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.inv_matrix.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0883</span>: 		<span class="k">return</span> <span class="n">Carr_to_NParr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_Carr_to_NParr(__pyx_v_self-&gt;iT));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0884</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0885</span>: 	<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">dx</span><span class="p">,</span> <span class="n">double</span> <span class="n">dy</span><span class="p">,</span> <span class="n">double</span> <span class="n">dz</span><span class="p">):</span></pre>
<pre class='cython code score-62 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_dx;
  double __pyx_v_dy;
  double __pyx_v_dz;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dx,&amp;__pyx_n_s_dy,&amp;__pyx_n_s_dz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "translate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_dx = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_dx == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L3_error)</span>
    __pyx_v_dy = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_dy == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L3_error)</span>
    __pyx_v_dz = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_dz == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_2translate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self), __pyx_v_dx, __pyx_v_dy, __pyx_v_dz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_2translate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self, double __pyx_v_dx, double __pyx_v_dy, double __pyx_v_dz) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("translate", __pyx_f[0], 885, 0, <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0886</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">dx</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 3;
  (__pyx_v_self-&gt;T[__pyx_t_1]) = ((__pyx_v_self-&gt;T[__pyx_t_1]) + __pyx_v_dx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0887</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span>  <span class="o">+=</span> <span class="n">dy</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 7;
  (__pyx_v_self-&gt;T[__pyx_t_1]) = ((__pyx_v_self-&gt;T[__pyx_t_1]) + __pyx_v_dy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0888</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dz</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 11;
  (__pyx_v_self-&gt;T[__pyx_t_1]) = ((__pyx_v_self-&gt;T[__pyx_t_1]) + __pyx_v_dz);
</pre><pre class="cython line score-0">&#xA0;<span class="">0889</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span>  <span class="o">-=</span> <span class="n">dx</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 3;
  (__pyx_v_self-&gt;iT[__pyx_t_1]) = ((__pyx_v_self-&gt;iT[__pyx_t_1]) - __pyx_v_dx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span>  <span class="o">-=</span> <span class="n">dy</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 7;
  (__pyx_v_self-&gt;iT[__pyx_t_1]) = ((__pyx_v_self-&gt;iT[__pyx_t_1]) - __pyx_v_dy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0892</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span> <span class="o">-=</span> <span class="n">dz</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 11;
  (__pyx_v_self-&gt;iT[__pyx_t_1]) = ((__pyx_v_self-&gt;iT[__pyx_t_1]) - __pyx_v_dz);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0893</span>: 		<span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0894</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0898</span>: 	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-34 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Transform_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 898, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 898, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_axis = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 898, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_4rotate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self), __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Transform_4rotate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self, PyObject *__pyx_v_axis, PyObject *__pyx_v_angle) {
  PyArrayObject *__pyx_v_nT = 0;
  PyArrayObject *__pyx_v_T = 0;
  PyArrayObject *__pyx_v_inT = 0;
  int __pyx_v_i;
  double __pyx_v_t;
  double __pyx_v_it;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rotate", __pyx_f[0], 898, 0, <span class='error_goto'>__PYX_ERR(0, 898, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Transform.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_nT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_inT);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0899</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">nT</span> <span class="o">=</span> <span class="n">new_rotationT</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_new_rotationT(__pyx_v_axis, __pyx_v_angle));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_nT = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0900</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">T</span> <span class="o">=</span> <span class="n">Carr_to_NParr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_Carr_to_NParr(__pyx_v_self-&gt;T));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_T = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0901</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0902</span>: 		<span class="n">nT</span> <span class="o">=</span> <span class="n">nT</span><span class="nd">@T</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_MatrixMultiply</span>(((PyObject *)__pyx_v_nT), ((PyObject *)__pyx_v_T));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 902, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 902, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nT, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0903</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0904</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">inT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">nT</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_v_nT)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_nT));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L1_error)</span>
  __pyx_v_inT = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0905</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">it</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0908</span>: </pre>
<pre class="cython line score-123" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0909</span>: 		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nT</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">inT</span><span class="o">.</span><span class="n">flat</span><span class="p">)):</span></pre>
<pre class='cython code score-123 '>  __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_nT), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_inT), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_10 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_t = __pyx_t_10;
    __pyx_v_it = __pyx_t_11;
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = (__pyx_t_4 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0910</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;T[__pyx_v_i]) = __pyx_v_t;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0911</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;iT[__pyx_v_i]) = __pyx_v_it;
</pre><pre class="cython line score-0">&#xA0;<span class="">0912</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0913</span>: 		<span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0914</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0917</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">rpos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_9Transform_inv_pos(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_rpos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_pos", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_pos", __pyx_f[0], 917, 0, <span class='error_goto'>__PYX_ERR(0, 917, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Transform.inv_pos", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0918</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">pos</span> <span class="o">=</span> <span class="n">rpos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos = __pyx_v_rpos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.x = (((((__pyx_v_self-&gt;iT[0]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[1]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[2]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.y = (((((__pyx_v_self-&gt;iT[4]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[5]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[6]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0921</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.z = (((((__pyx_v_self-&gt;iT[8]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[9]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[10]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0922</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0923</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_dire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">rdire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_9Transform_inv_dire(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_rdire) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_dire;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_dire", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_dire", __pyx_f[0], 923, 0, <span class='error_goto'>__PYX_ERR(0, 923, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Transform.inv_dire", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0924</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">dire</span> <span class="o">=</span> <span class="n">rdire</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dire = __pyx_v_rdire;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0925</span>: 		<span class="n">rdire</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rdire.x = (((((__pyx_v_self-&gt;iT[0]) * __pyx_v_dire.x) + ((__pyx_v_self-&gt;iT[1]) * __pyx_v_dire.y)) + ((__pyx_v_self-&gt;iT[2]) * __pyx_v_dire.z)) + (__pyx_v_self-&gt;iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0926</span>: 		<span class="n">rdire</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rdire.y = (((((__pyx_v_self-&gt;iT[4]) * __pyx_v_dire.x) + ((__pyx_v_self-&gt;iT[5]) * __pyx_v_dire.y)) + ((__pyx_v_self-&gt;iT[6]) * __pyx_v_dire.z)) + (__pyx_v_self-&gt;iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0927</span>: 		<span class="n">rdire</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rdire.z = (((((__pyx_v_self-&gt;iT[8]) * __pyx_v_dire.x) + ((__pyx_v_self-&gt;iT[9]) * __pyx_v_dire.y)) + ((__pyx_v_self-&gt;iT[10]) * __pyx_v_dire.z)) + (__pyx_v_self-&gt;iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0928</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0932</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_9Transform_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_rpos;
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_rdire;
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 932, 0, <span class='error_goto'>__PYX_ERR(0, 932, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Transform.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0933</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">rpos</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0934</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.x = (((((__pyx_v_self-&gt;iT[0]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[1]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[2]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0935</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.y = (((((__pyx_v_self-&gt;iT[4]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[5]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[6]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0936</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.z = (((((__pyx_v_self-&gt;iT[8]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[9]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[10]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0937</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0938</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">rdire</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0939</span>: 		<span class="n">rdire</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rdire.x = (((((__pyx_v_self-&gt;iT[0]) * __pyx_v_dire.x) + ((__pyx_v_self-&gt;iT[1]) * __pyx_v_dire.y)) + ((__pyx_v_self-&gt;iT[2]) * __pyx_v_dire.z)) + (__pyx_v_self-&gt;iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0940</span>: 		<span class="n">rdire</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rdire.y = (((((__pyx_v_self-&gt;iT[4]) * __pyx_v_dire.x) + ((__pyx_v_self-&gt;iT[5]) * __pyx_v_dire.y)) + ((__pyx_v_self-&gt;iT[6]) * __pyx_v_dire.z)) + (__pyx_v_self-&gt;iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0941</span>: 		<span class="n">rdire</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rdire.z = (((((__pyx_v_self-&gt;iT[8]) * __pyx_v_dire.x) + ((__pyx_v_self-&gt;iT[9]) * __pyx_v_dire.y)) + ((__pyx_v_self-&gt;iT[10]) * __pyx_v_dire.z)) + (__pyx_v_self-&gt;iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0942</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0943</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">rpos</span><span class="p">,</span> <span class="n">rdire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self-&gt;primitive-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.intersect(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;primitive), __pyx_v_rpos, __pyx_v_rdire);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0944</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0945</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_9Transform_is_inside(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_rpos;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 945, 0, <span class='error_goto'>__PYX_ERR(0, 945, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Transform.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0946</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">rpos</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0947</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.x = (((((__pyx_v_self-&gt;iT[0]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[1]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[2]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0948</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.y = (((((__pyx_v_self-&gt;iT[4]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[5]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[6]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0949</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.z = (((((__pyx_v_self-&gt;iT[8]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;iT[9]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;iT[10]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0950</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0951</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">rpos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self-&gt;primitive-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;primitive), __pyx_v_rpos);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0952</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0954</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Isometry</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Isometry {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Isometry *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Isometry;

</pre><pre class="cython line score-0">&#xA0;<span class="">0955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0957</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Primitive</span> <span class="n">primitive</span><span class="p">,</span> <span class="n">cnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">T</span><span class="p">,</span> <span class="n">cnp</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">iT</span><span class="p">):</span></pre>
<pre class='cython code score-43 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_8Isometry_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_8Isometry_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive = 0;
  PyArrayObject *__pyx_v_T = 0;
  PyArrayObject *__pyx_v_iT = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_primitive,&amp;__pyx_n_s_T,&amp;__pyx_n_s_iT,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_primitive)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_iT)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_primitive = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)values[0]);
    __pyx_v_T = ((PyArrayObject *)values[1]);
    __pyx_v_iT = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Isometry.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_primitive), __pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive, 1, "primitive", 0))) <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_T), __pyx_ptype_5numpy_ndarray, 1, "T", 0))) <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_iT), __pyx_ptype_5numpy_ndarray, 1, "iT", 0))) <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Isometry___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry *)__pyx_v_self), __pyx_v_primitive, __pyx_v_T, __pyx_v_iT);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_8Isometry___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive, PyArrayObject *__pyx_v_T, PyArrayObject *__pyx_v_iT) {
  int __pyx_v_i;
  double __pyx_v_t;
  double __pyx_v_it;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 957, 0, <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Isometry.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0958</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">primitive</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.primitive);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.primitive));
  __pyx_v_self-&gt;__pyx_base.primitive = __pyx_v_primitive;
</pre><pre class="cython line score-0">&#xA0;<span class="">0959</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">it</span></pre>
<pre class="cython line score-123" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0962</span>: 		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">iT</span><span class="o">.</span><span class="n">flat</span><span class="p">)):</span></pre>
<pre class='cython code score-123 '>  __pyx_t_1 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_T), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_iT), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 962, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_10 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_t = __pyx_t_10;
    __pyx_v_it = __pyx_t_11;
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = (__pyx_t_1 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0963</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.T[__pyx_v_i]) = __pyx_v_t;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0964</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.iT[__pyx_v_i]) = __pyx_v_it;
</pre><pre class="cython line score-0">&#xA0;<span class="">0965</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0967</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">rpos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_8Isometry_inv_pos(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_rpos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_pos", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_pos", __pyx_f[0], 967, 0, <span class='error_goto'>__PYX_ERR(0, 967, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Isometry.inv_pos", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0968</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;Isometry.inv_pos&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0969</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">pos</span> <span class="o">=</span> <span class="n">rpos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos = __pyx_v_rpos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0970</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.x = (((((__pyx_v_self-&gt;__pyx_base.iT[0]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[1]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[2]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;__pyx_base.iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0971</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.y = (((((__pyx_v_self-&gt;__pyx_base.iT[4]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[5]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[6]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;__pyx_base.iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0972</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.z = (((((__pyx_v_self-&gt;__pyx_base.iT[8]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[9]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[10]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;__pyx_base.iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0973</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0978</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_dire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_8Isometry_inv_dire(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_tmp_pos;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_dire", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_dire", __pyx_f[0], 978, 0, <span class='error_goto'>__PYX_ERR(0, 978, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Isometry.inv_dire", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0979</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;Isometry.inv_dire&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0981</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">tmp_pos</span> <span class="o">=</span> <span class="n">pos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_tmp_pos = __pyx_v_pos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0982</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.x = ((((__pyx_v_self-&gt;__pyx_base.iT[0]) * __pyx_v_tmp_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[1]) * __pyx_v_tmp_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[2]) * __pyx_v_tmp_pos.z));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0983</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.y = ((((__pyx_v_self-&gt;__pyx_base.iT[4]) * __pyx_v_tmp_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[5]) * __pyx_v_tmp_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[6]) * __pyx_v_tmp_pos.z));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0984</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.z = ((((__pyx_v_self-&gt;__pyx_base.iT[8]) * __pyx_v_tmp_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[9]) * __pyx_v_tmp_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[10]) * __pyx_v_tmp_pos.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">0985</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0988</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_8Isometry_SDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_rpos;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 988, 0, <span class='error_goto'>__PYX_ERR(0, 988, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Isometry.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0989</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">rpos</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0990</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.x = (((((__pyx_v_self-&gt;__pyx_base.iT[0]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[1]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[2]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;__pyx_base.iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0991</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.y = (((((__pyx_v_self-&gt;__pyx_base.iT[4]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[5]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[6]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;__pyx_base.iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0992</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.z = (((((__pyx_v_self-&gt;__pyx_base.iT[8]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.iT[9]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.iT[10]) * __pyx_v_pos.z)) + (__pyx_v_self-&gt;__pyx_base.iT[11]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0993</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">rpos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self-&gt;__pyx_base.primitive-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.primitive), __pyx_v_rpos);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0994</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1000</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Identity</span><span class="p">(</span><span class="n">Isometry</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Identity {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Isometry __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Identity *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Identity;

</pre><pre class="cython line score-0">&#xA0;<span class="">1001</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1002</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Primitive</span> <span class="n">primitive</span><span class="p">):</span></pre>
<pre class='cython code score-22 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_primitive,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_primitive)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1002, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_primitive = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)values[0]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1002, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Identity.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_primitive), __pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive, 1, "primitive", 0))) <span class='error_goto'>__PYX_ERR(0, 1002, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *)__pyx_v_self), __pyx_v_primitive);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive) {
  int __pyx_v_i;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1002, 0, <span class='error_goto'>__PYX_ERR(0, 1002, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Identity.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1003</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">primitive</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  __pyx_v_self-&gt;__pyx_base.__pyx_base.primitive = __pyx_v_primitive;
</pre><pre class="cython line score-0">&#xA0;<span class="">1004</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1005</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">16</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 16; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1006</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[__pyx_v_i]) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1007</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[__pyx_v_i]) = 0.0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[0]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1010</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[5]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1011</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[10]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1012</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[15]) = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1013</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1014</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[0]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1015</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[5]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1016</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[10]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1017</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[15]) = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1022</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_8Identity_inv_pos(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_pos", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_pos", __pyx_f[0], 1022, 0, <span class='error_goto'>__PYX_ERR(0, 1022, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Identity.inv_pos", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1023</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1024</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_dire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_8Identity_inv_dire(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_dire", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_dire", __pyx_f[0], 1025, 0, <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Identity.inv_dire", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1026</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1028</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1029</span>: 	<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">):</span></pre>
<pre class='cython code score-34 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dx = 0;
  PyObject *__pyx_v_dy = 0;
  PyObject *__pyx_v_dz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dx,&amp;__pyx_n_s_dy,&amp;__pyx_n_s_dz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "translate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_dx = values[0];
    __pyx_v_dy = values[1];
    __pyx_v_dz = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Identity.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity_2translate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *)__pyx_v_self), __pyx_v_dx, __pyx_v_dy, __pyx_v_dz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity_2translate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, PyObject *__pyx_v_dx, PyObject *__pyx_v_dy, PyObject *__pyx_v_dz) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("translate", __pyx_f[0], 1029, 0, <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Identity.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>: 		<span class="k">return</span> <span class="n">Translation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dy);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_dy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dz);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_v_dz);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Translation), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1031</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1032</span>: 	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-28 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_axis = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Identity.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity_4rotate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *)__pyx_v_self), __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity_4rotate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, PyObject *__pyx_v_axis, PyObject *__pyx_v_angle) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rotate", __pyx_f[0], 1032, 0, <span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Identity.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>: 		<span class="k">return</span> <span class="n">Rotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1033, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_axis);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_axis);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_axis);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_angle);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_angle);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_angle);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Rotation), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1034</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1035</span>: 	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_7scale(PyObject *__pyx_v_self, PyObject *__pyx_v_s); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Identity_7scale(PyObject *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scale (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity_6scale(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *)__pyx_v_self), ((PyObject *)__pyx_v_s));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_8Identity_6scale(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scale", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scale", __pyx_f[0], 1035, 0, <span class='error_goto'>__PYX_ERR(0, 1035, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Identity.scale", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1036</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive), __pyx_n_s_scale);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1036, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_s) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1036, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1037</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1038</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_8Identity_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1038, 0, <span class='error_goto'>__PYX_ERR(0, 1038, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Identity.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1039</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.intersect(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive), __pyx_v_pos, __pyx_v_dire);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1040</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1041</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_8Identity_SDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Identity *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1041, 0, <span class='error_goto'>__PYX_ERR(0, 1041, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Identity.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1042</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive), __pyx_v_pos);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>: 	<span class="c">#def matrix(self):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1045</span>: 	<span class="c">#	cdef cnp.ndarray m = np.zeros((4, 4))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>: 	<span class="c">#	cdef int i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1047</span>: 	<span class="c">#	for i in range(4):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>: 	<span class="c">#		m[i, i] = 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>: 	<span class="c">#	return m</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1052</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">NonIsometry</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_NonIsometry {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_NonIsometry {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_NonIsometry *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_NonIsometry;

</pre><pre class="cython line score-0">&#xA0;<span class="">1053</span>: 	<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1056</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1057</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1059</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Translation</span><span class="p">(</span><span class="n">Isometry</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Translation {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Isometry __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Translation *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Translation;

</pre><pre class="cython line score-0">&#xA0;<span class="">1060</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1061</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Primitive</span> <span class="n">primitive</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">):</span></pre>
<pre class='cython code score-41 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_11Translation_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_11Translation_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive = 0;
  PyObject *__pyx_v_dx = 0;
  PyObject *__pyx_v_dy = 0;
  PyObject *__pyx_v_dz = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_primitive,&amp;__pyx_n_s_dx,&amp;__pyx_n_s_dy,&amp;__pyx_n_s_dz,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_primitive)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1061, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1061, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 1061, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1061, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_primitive = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)values[0]);
    __pyx_v_dx = values[1];
    __pyx_v_dy = values[2];
    __pyx_v_dz = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1061, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Translation.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_primitive), __pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive, 1, "primitive", 0))) <span class='error_goto'>__PYX_ERR(0, 1061, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_11Translation___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *)__pyx_v_self), __pyx_v_primitive, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_11Translation___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive, PyObject *__pyx_v_dx, PyObject *__pyx_v_dy, PyObject *__pyx_v_dz) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1061, 0, <span class='error_goto'>__PYX_ERR(0, 1061, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Translation.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1062</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1063</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">primitive</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  __pyx_v_self-&gt;__pyx_base.__pyx_base.primitive = __pyx_v_primitive;
</pre><pre class="cython line score-0">&#xA0;<span class="">1064</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1065</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dx</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_dx); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L1_error)</span>
  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[3]) = __pyx_t_1;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dy</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_dy); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1066, __pyx_L1_error)</span>
  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[7]) = __pyx_t_1;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1067</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">dz</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_dz); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1067, __pyx_L1_error)</span>
  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[11]) = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1068</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1069</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span>  <span class="o">=</span> <span class="o">-</span><span class="n">dx</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_dx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1069, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1069, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[3]) = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1070</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span>  <span class="o">=</span> <span class="o">-</span><span class="n">dy</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_dy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1070, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1070, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[7]) = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dz</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_dz);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1071, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1071, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[11]) = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1072</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1073</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[0]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1074</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[5]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1075</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[10]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1076</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[15]) = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1077</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1078</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[0]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1079</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[5]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1080</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[10]) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1081</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">15</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[15]) = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1083</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_11Translation_inv_pos(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_pos", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_pos", __pyx_f[0], 1084, 0, <span class='error_goto'>__PYX_ERR(0, 1084, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Translation.inv_pos", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1085</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.x = (__pyx_v_pos.x + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1086</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.y = (__pyx_v_pos.y + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.z = (__pyx_v_pos.z + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1088</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1089</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_dire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_11Translation_inv_dire(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_dire", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_dire", __pyx_f[0], 1089, 0, <span class='error_goto'>__PYX_ERR(0, 1089, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Translation.inv_dire", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1090</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1091</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_11Translation_SDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1092, 0, <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Translation.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1093</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.x = (__pyx_v_pos.x + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1094</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.y = (__pyx_v_pos.y + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.z = (__pyx_v_pos.z + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1096</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive), __pyx_v_pos);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1098</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1099</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_11Translation_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1099, 0, <span class='error_goto'>__PYX_ERR(0, 1099, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Translation.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.x = (__pyx_v_pos.x + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[3]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1101</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.y = (__pyx_v_pos.y + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[7]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1102</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">11</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.z = (__pyx_v_pos.z + (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[11]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1103</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.intersect(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive), __pyx_v_pos, __pyx_v_dire);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1105</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1106</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>: 	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-32 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_11Translation_3rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_10MontyCarlo_8geometry_3CSG_11Translation_2rotate[] = "\n\t\tR * T yields a general isometry.\n\t\t";
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_11Translation_3rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_axis = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Translation.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_11Translation_2rotate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *)__pyx_v_self), __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_11Translation_2rotate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Translation *__pyx_v_self, PyObject *__pyx_v_axis, PyObject *__pyx_v_angle) {
  PyArrayObject *__pyx_v_rot = 0;
  PyArrayObject *__pyx_v_T = 0;
  PyArrayObject *__pyx_v_iT = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rotate", __pyx_f[0], 1107, 0, <span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Translation.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rot);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_iT);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1108</span>: 		<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1109</span>: <span class="sd">		R * T yields a general isometry.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1110</span>: <span class="sd">		&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1111</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">rot</span> <span class="o">=</span> <span class="n">new_rotationT</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_new_rotationT(__pyx_v_axis, __pyx_v_angle));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_rot = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">T</span> <span class="o">=</span> <span class="n">rot</span> <span class="err">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_MatrixMultiply</span>(((PyObject *)__pyx_v_rot), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1113, __pyx_L1_error)</span>
  __pyx_v_T = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1114</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">iT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inv);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, ((PyObject *)__pyx_v_T)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, ((PyObject *)__pyx_v_T));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1114, __pyx_L1_error)</span>
  __pyx_v_iT = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1115</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>: 		<span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primitive</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">iT</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_T));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_T));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_T));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_iT));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_iT));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_iT));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Isometry), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1117</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1119</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1120</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1122</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1123</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1124</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Rotation</span><span class="p">(</span><span class="n">Isometry</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Isometry __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Rotation {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Isometry __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Rotation *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Rotation;

</pre><pre class="cython line score-0">&#xA0;<span class="">1125</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1126</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Primitive</span> <span class="n">primitive</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-41 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_8Rotation_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_8Rotation_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angle = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_primitive,&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_primitive)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_primitive = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)values[0]);
    __pyx_v_axis = values[1];
    __pyx_v_angle = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Rotation.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_primitive), __pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive, 1, "primitive", 0))) <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Rotation___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *)__pyx_v_self), __pyx_v_primitive, __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_8Rotation___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_primitive, PyObject *__pyx_v_axis, PyObject *__pyx_v_angle) {
  PyArrayObject *__pyx_v_T = 0;
  PyArrayObject *__pyx_v_iT = 0;
  int __pyx_v_i;
  double __pyx_v_t;
  double __pyx_v_it;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1126, 0, <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Rotation.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_iT);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1127</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">primitive</span> <span class="o">=</span> <span class="n">primitive</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_primitive));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.primitive));
  __pyx_v_self-&gt;__pyx_base.__pyx_base.primitive = __pyx_v_primitive;
</pre><pre class="cython line score-0">&#xA0;<span class="">1128</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1130</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1131</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">T</span> <span class="o">=</span> <span class="n">new_rotationT</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_new_rotationT(__pyx_v_axis, __pyx_v_angle));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_T = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1132</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">iT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_v_T)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_T));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
  __pyx_v_iT = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1134</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1135</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">it</span></pre>
<pre class="cython line score-123" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>: 		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">iT</span><span class="o">.</span><span class="n">flat</span><span class="p">)):</span></pre>
<pre class='cython code score-123 '>  __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_T), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_iT), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_10 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_t = __pyx_t_10;
    __pyx_v_it = __pyx_t_11;
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = (__pyx_t_4 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[__pyx_v_i]) = __pyx_v_t;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1138</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[__pyx_v_i]) = __pyx_v_it;
</pre><pre class="cython line score-0">&#xA0;<span class="">1139</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1140</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1141</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">rpos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_8Rotation_inv_pos(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_rpos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_pos", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_pos", __pyx_f[0], 1141, 0, <span class='error_goto'>__PYX_ERR(0, 1141, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Rotation.inv_pos", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">pos</span> <span class="o">=</span> <span class="n">rpos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos = __pyx_v_rpos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1143</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.x = ((((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[0]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[1]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[2]) * __pyx_v_pos.z));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1144</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.y = ((((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[4]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[5]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[6]) * __pyx_v_pos.z));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1145</span>: 		<span class="n">rpos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rpos.z = ((((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[8]) * __pyx_v_pos.x) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[9]) * __pyx_v_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[10]) * __pyx_v_pos.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">1146</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1148</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1150</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1151</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">inv_dire</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_8Rotation_inv_dire(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_tmp_pos;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inv_dire", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inv_dire", __pyx_f[0], 1151, 0, <span class='error_goto'>__PYX_ERR(0, 1151, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Rotation.inv_dire", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1152</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">tmp_pos</span> <span class="o">=</span> <span class="n">pos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_tmp_pos = __pyx_v_pos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1153</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.x = ((((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[0]) * __pyx_v_tmp_pos.x) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[1]) * __pyx_v_tmp_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[2]) * __pyx_v_tmp_pos.z));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1154</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.y = ((((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[4]) * __pyx_v_tmp_pos.x) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[5]) * __pyx_v_tmp_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[6]) * __pyx_v_tmp_pos.z));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1155</span>: 		<span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">9</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="mf">10</span><span class="p">]</span><span class="o">*</span><span class="n">tmp_pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos.z = ((((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[8]) * __pyx_v_tmp_pos.x) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[9]) * __pyx_v_tmp_pos.y)) + ((__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[10]) * __pyx_v_tmp_pos.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">1156</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1160</span>: 	<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">):</span></pre>
<pre class='cython code score-38 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Rotation_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Rotation_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dx = 0;
  PyObject *__pyx_v_dy = 0;
  PyObject *__pyx_v_dz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dx,&amp;__pyx_n_s_dy,&amp;__pyx_n_s_dz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "translate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_dx = values[0];
    __pyx_v_dy = values[1];
    __pyx_v_dz = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Rotation.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Rotation_2translate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *)__pyx_v_self), __pyx_v_dx, __pyx_v_dy, __pyx_v_dz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_8Rotation_2translate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *__pyx_v_self, PyObject *__pyx_v_dx, PyObject *__pyx_v_dy, PyObject *__pyx_v_dz) {
  PyArrayObject *__pyx_v_T = 0;
  PyArrayObject *__pyx_v_iT = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("translate", __pyx_f[0], 1160, 0, <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Rotation.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_iT);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1161</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">))</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_tuple__26) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_tuple__26);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1161, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1161, __pyx_L1_error)</span>
  __pyx_v_T = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1162</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1163</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__27, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1164</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[1]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__28, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1165</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[2]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1165, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__29, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1165, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1166</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">dx</span></pre>
<pre class='cython code score-10 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__47, __pyx_v_dx) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1166, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);
</pre><pre class="cython line score-0">&#xA0;<span class="">1167</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1168</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[3]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__30, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1168, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1169</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[4]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1169, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__31, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1169, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1170</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[5]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__32, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1171</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">dy</span></pre>
<pre class='cython code score-10 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__48, __pyx_v_dy) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__48 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__48);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__48);
</pre><pre class="cython line score-0">&#xA0;<span class="">1172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1173</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1174</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[6]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1174, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__33, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1174, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[7]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__34, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1175, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1176</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mf">8</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;__pyx_base.__pyx_base.T[8]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__35, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1176, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">dz</span></pre>
<pre class='cython code score-10 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__49, __pyx_v_dz) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1177, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__49 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__49);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__49);
</pre><pre class="cython line score-0">&#xA0;<span class="">1178</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1179</span>: 		<span class="n">T</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-49 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_int_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__50 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__50)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__50);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__50);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_T), __pyx_tuple__51, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__51 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_3, __pyx_slice__50);<span class='error_goto'> if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__51);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__51);
</pre><pre class="cython line score-0">&#xA0;<span class="">1180</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1181</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">iT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_v_T)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_T));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
  __pyx_v_iT = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1182</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1183</span>: 		<span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">iT</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_self));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_T));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_T));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_T));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_iT));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_iT));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)__pyx_v_iT));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Isometry), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1184</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1185</span>: 	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-34 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Rotation_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_8Rotation_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1185, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1185, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_axis = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1185, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Rotation.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_8Rotation_4rotate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *)__pyx_v_self), __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_8Rotation_4rotate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Rotation *__pyx_v_self, PyObject *__pyx_v_axis, PyObject *__pyx_v_angle) {
  PyArrayObject *__pyx_v_rot = 0;
  PyArrayObject *__pyx_v_T = 0;
  PyObject *__pyx_v_iT = NULL;
  int __pyx_v_i;
  double __pyx_v_t;
  double __pyx_v_it;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rotate", __pyx_f[0], 1185, 0, <span class='error_goto'>__PYX_ERR(0, 1185, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Rotation.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rot);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_T);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_iT);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1186</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">rot</span> <span class="o">=</span> <span class="n">new_rotationT</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_new_rotationT(__pyx_v_axis, __pyx_v_angle));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_rot = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1187</span>: 		<span class="k">cdef</span> <span class="kt">cnp</span>.<span class="kt">ndarray</span> <span class="nf">T</span> <span class="o">=</span> <span class="n">Carr_to_NParr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_f_10MontyCarlo_8geometry_3CSG_Carr_to_NParr(__pyx_v_self-&gt;__pyx_base.__pyx_base.T));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1187, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_T = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1188</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1189</span>: 		<span class="n">T</span> <span class="o">=</span> <span class="n">rot</span> <span class="err">@</span> <span class="n">T</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_MatrixMultiply</span>(((PyObject *)__pyx_v_rot), ((PyObject *)__pyx_v_T));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1189, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_T, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1190</span>: 		<span class="n">iT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">T</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_v_T)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, ((PyObject *)__pyx_v_T));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_iT = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1192</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1193</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">it</span></pre>
<pre class="cython line score-123" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1194</span>: 		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">iT</span><span class="o">.</span><span class="n">flat</span><span class="p">)):</span></pre>
<pre class='cython code score-123 '>  __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_T), __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_iT, __pyx_n_s_flat);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_1 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_10 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_t = __pyx_t_10;
    __pyx_v_it = __pyx_t_11;
    __pyx_v_i = __pyx_t_4;
    __pyx_t_4 = (__pyx_t_4 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1195</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.__pyx_base.T[__pyx_v_i]) = __pyx_v_t;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1196</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">iT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">it</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;__pyx_base.__pyx_base.iT[__pyx_v_i]) = __pyx_v_it;
</pre><pre class="cython line score-0">&#xA0;<span class="">1197</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1198</span>: 		<span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1199</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1200</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1201</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1203</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1205</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1206</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1208</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1209</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1210</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1213</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1214</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1216</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1217</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1224</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1225</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1227</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1229</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1230</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>: <span class="c">#   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄        ▄  ▄▄▄▄▄▄▄▄▄▄▄ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>: <span class="c">#  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░▌      ▐░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: <span class="c">#  ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌ ▀▀▀▀█░█▀▀▀▀  ▀▀▀▀█░█▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌▐░▌░▌     ▐░▌▐░█▀▀▀▀▀▀▀▀▀ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>: <span class="c">#  ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌          ▐░▌       ▐░▌▐░▌       ▐░▌     ▐░▌          ▐░▌     ▐░▌       ▐░▌▐░▌▐░▌    ▐░▌▐░▌          </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>: <span class="c">#  ▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌     ▐░▌          ▐░▌     ▐░▌       ▐░▌▐░▌ ▐░▌   ▐░▌▐░█▄▄▄▄▄▄▄▄▄ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>: <span class="c">#  ▐░▌       ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     ▐░▌          ▐░▌     ▐░▌       ▐░▌▐░▌  ▐░▌  ▐░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>: <span class="c">#  ▐░▌       ▐░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀█░█▀▀ ▐░█▀▀▀▀▀▀▀█░▌     ▐░▌          ▐░▌     ▐░▌       ▐░▌▐░▌   ▐░▌ ▐░▌ ▀▀▀▀▀▀▀▀▀█░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>: <span class="c">#  ▐░▌       ▐░▌▐░▌          ▐░▌          ▐░▌     ▐░▌  ▐░▌       ▐░▌     ▐░▌          ▐░▌     ▐░▌       ▐░▌▐░▌    ▐░▌▐░▌          ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>: <span class="c">#  ▐░█▄▄▄▄▄▄▄█░▌▐░▌          ▐░█▄▄▄▄▄▄▄▄▄ ▐░▌      ▐░▌ ▐░▌       ▐░▌     ▐░▌      ▄▄▄▄█░█▄▄▄▄ ▐░█▄▄▄▄▄▄▄█░▌▐░▌     ▐░▐░▌ ▄▄▄▄▄▄▄▄▄█░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1252</span>: <span class="c">#  ▐░░░░░░░░░░░▌▐░▌          ▐░░░░░░░░░░░▌▐░▌       ▐░▌▐░▌       ▐░▌     ▐░▌     ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌      ▐░░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1253</span>: <span class="c">#   ▀▀▀▀▀▀▀▀▀▀▀  ▀            ▀▀▀▀▀▀▀▀▀▀▀  ▀         ▀  ▀         ▀       ▀       ▀▀▀▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀▀▀▀▀  ▀        ▀▀  ▀▀▀▀▀▀▀▀▀▀▀ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1254</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta</span> <span class="o">=</span> <span class="mf">1e-10</span></pre>
<pre class='cython code score-0 '>  __pyx_v_10MontyCarlo_8geometry_3CSG_delta = 1e-10;
</pre><pre class="cython line score-0">&#xA0;<span class="">1257</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1258</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">CSGop</span><span class="p">(</span><span class="n">CSGvol</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *R;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *L;
  double (*rule)(double, double);
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGop {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGop *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_CSGop;

</pre><pre class="cython line score-0">&#xA0;<span class="">1260</span>: 	<span class="k">cdef</span> <span class="kt">CSGvol</span> <span class="nf">R</span><span class="p">,</span> <span class="nf">L</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1261</span>: 	<span class="k">cdef</span> <span class="nf">double</span> <span class="p">(</span><span class="o">*</span><span class="n">rule</span><span class="p">)(</span><span class="n">double</span><span class="p">,</span> <span class="n">double</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1262</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">L</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">R</span><span class="p">):</span></pre>
<pre class='cython code score-30 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_5CSGop_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_5CSGop_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L = 0;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_L,&amp;__pyx_n_s_R,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_L)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_R)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_L = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[0]);
    __pyx_v_R = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGop.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_L), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "L", 0))) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_R), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "R", 0))) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_5CSGop___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *)__pyx_v_self), __pyx_v_L, __pyx_v_R);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_5CSGop___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1263, 0, <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGop.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_L));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_L));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;L);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;L));
  __pyx_v_self-&gt;L = __pyx_v_L;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_R));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_R));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;R);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;R));
  __pyx_v_self-&gt;R = __pyx_v_R;
</pre><pre class="cython line score-0">&#xA0;<span class="">1266</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_5CSGop_is_inside(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 1267, 0, <span class='error_goto'>__PYX_ERR(0, 1267, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGop.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1268</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;is_inside&#39; called from virtual Volume.BVH.CSGvol.CSGop&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__54, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 1268, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__54 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_is_inside_called_from_virtual_V);<span class='error_goto'> if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__54);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__54);
</pre><pre class="cython line score-0">&#xA0;<span class="">1269</span>: </pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1270</span>: 	<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">):</span></pre>
<pre class='cython code score-37 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_5CSGop_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_5CSGop_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dx = 0;
  PyObject *__pyx_v_dy = 0;
  PyObject *__pyx_v_dz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dx,&amp;__pyx_n_s_dy,&amp;__pyx_n_s_dz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "translate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_dx = values[0];
    __pyx_v_dy = values[1];
    __pyx_v_dz = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGop.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_5CSGop_2translate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *)__pyx_v_self), __pyx_v_dx, __pyx_v_dy, __pyx_v_dz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_5CSGop_2translate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *__pyx_v_self, PyObject *__pyx_v_dx, PyObject *__pyx_v_dy, PyObject *__pyx_v_dz) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("translate", __pyx_f[0], 1270, 0, <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGop.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1271</span>: 		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;L);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_t_1, __pyx_ptype_10MontyCarlo_8geometry_3CSG_Transform); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1272</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;L), __pyx_n_s_primitive);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1272, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_translate);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1272, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_6 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1272, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1272, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1272, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_v_dx);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dy);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dy);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_v_dy);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dz);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dz);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_dz);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1272, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>: 		<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;L), __pyx_n_s_translate);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_6 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_7) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_v_dx);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dy);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dy);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, __pyx_v_dy);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dz);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dz);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_6, __pyx_v_dz);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1274</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1275</span>: 		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">Transform</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;R);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_t_1, __pyx_ptype_10MontyCarlo_8geometry_3CSG_Transform); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1276</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">primitive</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;R), __pyx_n_s_primitive);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_translate);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (__pyx_t_5) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_v_dx);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dy);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dy);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_v_dy);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dz);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dz);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_dz);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1276, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1277</span>: 		<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  /*else*/ {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;R), __pyx_n_s_translate);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1277, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = NULL;
    __pyx_t_6 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1277, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1277, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1277, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (__pyx_t_7) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_7); __pyx_t_7 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_6, __pyx_v_dx);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dy);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dy);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_6, __pyx_v_dy);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dz);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dz);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_6, __pyx_v_dz);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1277, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1278</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1279</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1280</span>: 	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-31 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_5CSGop_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_5CSGop_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_axis = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGop.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_5CSGop_4rotate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *)__pyx_v_self), __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_5CSGop_4rotate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *__pyx_v_self, PyObject *__pyx_v_axis, PyObject *__pyx_v_angle) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rotate", __pyx_f[0], 1280, 0, <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.CSGop.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1281</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;L), __pyx_n_s_rotate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_axis, __pyx_v_angle};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1281, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_axis, __pyx_v_angle};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1281, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_axis);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_axis);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_axis);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_angle);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_angle);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_angle);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1282</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;R), __pyx_n_s_rotate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1282, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_axis, __pyx_v_angle};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1282, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_axis, __pyx_v_angle};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1282, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1282, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_axis);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_axis);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_4, __pyx_v_axis);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_angle);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_angle);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_4, __pyx_v_angle);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1282, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1283</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1284</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_5CSGop_intersect(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1284, 0, <span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.CSGop.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1285</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Called from virtual;&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__55, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 1285, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__55 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Called_from_virtual);<span class='error_goto'> if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 1285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__55);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__55);
</pre><pre class="cython line score-0">&#xA0;<span class="">1286</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1287</span>: 		<span class="c">#return self.rule(self.L.intersect(pos, dire), self.R.intersect(pos, dire))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1291</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Subtraction</span><span class="p">(</span><span class="n">CSGop</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Subtraction {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGop __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Subtraction *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Subtraction;

</pre><pre class="cython line score-0">&#xA0;<span class="">1292</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>: 	<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>: <span class="sd">	SDF:  max(-SDF_L, SDF_R)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1295</span>: <span class="sd">		</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1296</span>: <span class="sd">	RAY TRACE:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1297</span>: <span class="sd">		</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1298</span>: <span class="sd">		   L/R     IN    OUT     BORDER  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1299</span>: <span class="sd">		 -------- ---- -------- -------- </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1300</span>: <span class="sd">		  IN       OUT      IN       BORDER      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1301</span>: <span class="sd">		  OUT      OUT     OUT      OUT  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1302</span>: <span class="sd">		  BORDER   OUT  BORDER      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1303</span>: <span class="sd">		  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1304</span>: <span class="sd">		  1 = out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1305</span>: <span class="sd">		  -1 = in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1306</span>: <span class="sd">		  0 = border</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1307</span>: <span class="sd">			</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1308</span>: <span class="sd">	&quot;&quot;&quot;</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1309</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">L</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">R</span><span class="p">):</span></pre>
<pre class='cython code score-34 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_11Subtraction_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_11Subtraction_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L = 0;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_L,&amp;__pyx_n_s_R,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_L)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_R)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_L = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[0]);
    __pyx_v_R = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Subtraction.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_L), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "L", 0))) <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_R), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "R", 0))) <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_11Subtraction___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction *)__pyx_v_self), __pyx_v_L, __pyx_v_R);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_11Subtraction___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1309, 0, <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Subtraction.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1310</span>: 		<span class="c"># child nodes</span></pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1311</span>: 		<span class="nb">super</span><span class="p">(</span><span class="n">Subtraction</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span></pre>
<pre class='cython code score-53 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Subtraction));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Subtraction));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Subtraction));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_v_L), ((PyObject *)__pyx_v_R)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_v_L), ((PyObject *)__pyx_v_R)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_L));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_L));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, ((PyObject *)__pyx_v_L));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_R));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_R));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, ((PyObject *)__pyx_v_R));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1312</span>: 		<span class="c">#self.mesh = L.mesh - R.mesh</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1314</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1315</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1316</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1317</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_11Subtraction_SDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1317, 0, <span class='error_goto'>__PYX_ERR(0, 1317, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Subtraction.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1318</span>: 		<span class="k">return</span> <span class="n">fmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_r = fmax(((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.L), __pyx_v_pos), (-((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.R), __pyx_v_pos)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1319</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1320</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_11Subtraction_is_inside(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 1320, 0, <span class='error_goto'>__PYX_ERR(0, 1320, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Subtraction.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1321</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.L), __pyx_v_pos) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_2 = ((!(((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.R), __pyx_v_pos) != 0)) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L3_bool_binop_done:;
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1322</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1323</span>: 	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_11Subtraction_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_11Subtraction_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_11Subtraction_2__repr__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_11Subtraction_2__repr__(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 1323, 0, <span class='error_goto'>__PYX_ERR(0, 1323, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Subtraction.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1324</span>: 		<span class="k">return</span> <span class="s">&quot;&lt;Subtraction&gt;&quot;</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_Subtraction);
  __pyx_r = __pyx_kp_s_Subtraction;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1325</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1326</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_11Subtraction_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Subtraction *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_v_L;
  intLIST __pyx_v_R;
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1326, 0, <span class='error_goto'>__PYX_ERR(0, 1326, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Subtraction.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1327</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;SUBTRACTING: </span><span class="se">\n</span><span class="s"> --left-- </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1328</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_L = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self-&gt;__pyx_base.L, __pyx_v_pos, __pyx_v_dire);
</pre><pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1331</span>: 		<span class="k">if</span> <span class="n">L</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_L.size() == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>: 			<span class="k">return</span> <span class="n">L</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_L;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1333</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1334</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s"> --right-- </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1335</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_R = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self-&gt;__pyx_base.R, __pyx_v_pos, __pyx_v_dire);
</pre><pre class="cython line score-0">&#xA0;<span class="">1337</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>: 		<span class="k">if</span> <span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_R.size() == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1339</span>: 			<span class="k">return</span> <span class="n">L</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_L;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1340</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>: 		<span class="k">return</span> <span class="n">intMinus</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = intMinus(__pyx_v_L, __pyx_v_R);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1343</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1344</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1345</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1346</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1347</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1348</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1350</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Union</span><span class="p">(</span><span class="n">CSGop</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Union {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGop __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Union *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Union;

</pre><pre class="cython line score-0">&#xA0;<span class="">1352</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1353</span>: 	<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1354</span>: <span class="sd">	SDF:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1355</span>: <span class="sd">		min(SDF_a, SDF_b)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1356</span>: <span class="sd">		</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1357</span>: <span class="sd">	RAY TRACE:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1358</span>: <span class="sd">		</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1359</span>: <span class="sd">		   L/R     IN    OUT     BORDER  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1360</span>: <span class="sd">		 -------- ---- -------- -------- </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1361</span>: <span class="sd">		  IN       IN   IN       IN      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1362</span>: <span class="sd">		  OUT      IN   OUT      BORDER  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1363</span>: <span class="sd">		  BORDER   IN   BORDER      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1364</span>: <span class="sd">		  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1365</span>: <span class="sd">		  1 = out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1366</span>: <span class="sd">		  -1 = in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1367</span>: <span class="sd">		  0 = border</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1368</span>: <span class="sd">			</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1369</span>: <span class="sd">	&quot;&quot;&quot;</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">L</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">R</span><span class="p">):</span></pre>
<pre class='cython code score-34 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_5Union_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_5Union_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L = 0;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_L,&amp;__pyx_n_s_R,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_L)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_R)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_L = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[0]);
    __pyx_v_R = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Union.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_L), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "L", 0))) <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_R), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "R", 0))) <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_5Union___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union *)__pyx_v_self), __pyx_v_L, __pyx_v_R);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_5Union___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1370, 0, <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Union.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1371</span>: 		<span class="c"># child nodes</span></pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1372</span>: 		<span class="nb">super</span><span class="p">(</span><span class="n">Union</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span></pre>
<pre class='cython code score-53 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Union));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Union));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Union));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_v_L), ((PyObject *)__pyx_v_R)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1372, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_v_L), ((PyObject *)__pyx_v_R)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1372, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1372, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_L));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_L));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, ((PyObject *)__pyx_v_L));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_R));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_R));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, ((PyObject *)__pyx_v_R));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1372, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1373</span>: 		<span class="c">#self.mesh = L.mesh + R.mesh</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1374</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1375</span>: 	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_5Union_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_5Union_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_5Union_2__repr__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_5Union_2__repr__(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 1375, 0, <span class='error_goto'>__PYX_ERR(0, 1375, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Union.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1376</span>: 		<span class="k">return</span> <span class="s">&quot;&lt;Union&gt;&quot;</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_Union);
  __pyx_r = __pyx_kp_s_Union;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1377</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1378</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_5Union_SDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1378, 0, <span class='error_goto'>__PYX_ERR(0, 1378, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Union.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1379</span>: 		<span class="k">return</span> <span class="n">fmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_r = fmin(((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.L), __pyx_v_pos), ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.R), __pyx_v_pos));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1380</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1381</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_5Union_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_v_L;
  intLIST __pyx_v_R;
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1381, 0, <span class='error_goto'>__PYX_ERR(0, 1381, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Union.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1382</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;UNION: </span><span class="se">\n</span><span class="s"> --left-- </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1383</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1384</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_L = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self-&gt;__pyx_base.L, __pyx_v_pos, __pyx_v_dire);
</pre><pre class="cython line score-0">&#xA0;<span class="">1385</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1386</span>: 		<span class="k">if</span> <span class="n">L</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_L.size() == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1387</span>: 			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_r = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self-&gt;__pyx_base.R, __pyx_v_pos, __pyx_v_dire);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1388</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1389</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s"> --right-- </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1390</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1391</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_R = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self-&gt;__pyx_base.R, __pyx_v_pos, __pyx_v_dire);
</pre><pre class="cython line score-0">&#xA0;<span class="">1392</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1393</span>: 		<span class="k">if</span> <span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_R.size() == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1394</span>: 			<span class="k">return</span> <span class="n">L</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_L;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1395</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1396</span>: 		<span class="k">return</span> <span class="n">intPlus</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = intPlus(__pyx_v_L, __pyx_v_R);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1397</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1398</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_5Union_is_inside(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Union *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 1398, 0, <span class='error_goto'>__PYX_ERR(0, 1398, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Union.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1399</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.L), __pyx_v_pos) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_2 = (((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.R), __pyx_v_pos) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L3_bool_binop_done:;
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1400</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1401</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1402</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Intersection</span><span class="p">(</span><span class="n">CSGop</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGop __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Intersection {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGop __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Intersection *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Intersection;

</pre><pre class="cython line score-0">&#xA0;<span class="">1403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1404</span>: 	<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1405</span>: <span class="sd">	SDF:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1406</span>: <span class="sd">		max(SDF_a, SDF_b)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1407</span>: <span class="sd">		</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>: <span class="sd">	RAY TRACE:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1409</span>: <span class="sd">		</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>: <span class="sd">		   L/R     IN    OUT     BORDER  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>: <span class="sd">		 -------- ---- -------- -------- </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>: <span class="sd">		  IN       IN      OUT       BORDER      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: <span class="sd">		  OUT      OUT     OUT      OUT  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>: <span class="sd">		  BORDER   BORDER  OUT      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1415</span>: <span class="sd">		  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1416</span>: <span class="sd">		  1 = out</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>: <span class="sd">		  -1 = in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>: <span class="sd">		  0 = border</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>: <span class="sd">			</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>: <span class="sd">	&quot;&quot;&quot;</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1421</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">L</span><span class="p">,</span> <span class="n">CSGvol</span> <span class="n">R</span><span class="p">):</span></pre>
<pre class='cython code score-34 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_12Intersection_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_12Intersection_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L = 0;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_L,&amp;__pyx_n_s_R,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_L)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_R)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_L = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[0]);
    __pyx_v_R = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Intersection.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_L), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "L", 0))) <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_R), __pyx_ptype_10MontyCarlo_8geometry_3CSG_CSGvol, 1, "R", 0))) <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_12Intersection___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection *)__pyx_v_self), __pyx_v_L, __pyx_v_R);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_12Intersection___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection *__pyx_v_self, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_L, struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol *__pyx_v_R) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1421, 0, <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Intersection.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1422</span>: 		<span class="c"># child nodes</span></pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1423</span>: 		<span class="nb">super</span><span class="p">(</span><span class="n">Intersection</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span></pre>
<pre class='cython code score-53 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1423, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Intersection));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Intersection));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Intersection));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1423, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1423, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_v_L), ((PyObject *)__pyx_v_R)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1423, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, ((PyObject *)__pyx_v_L), ((PyObject *)__pyx_v_R)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1423, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1423, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_L));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_L));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, ((PyObject *)__pyx_v_L));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_R));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_R));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, ((PyObject *)__pyx_v_R));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1423, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1424</span>: 		<span class="c">#self.mesh = L.mesh.boolean_cut(R.mesh)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1426</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1427</span>: 	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_12Intersection_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_12Intersection_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_12Intersection_2__repr__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_12Intersection_2__repr__(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 1427, 0, <span class='error_goto'>__PYX_ERR(0, 1427, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Intersection.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1428</span>: 		<span class="k">return</span> <span class="s">&quot;&lt;Intersection&gt;&quot;</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_Intersection);
  __pyx_r = __pyx_kp_s_Intersection;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1429</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1430</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_12Intersection_SDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1430, 0, <span class='error_goto'>__PYX_ERR(0, 1430, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Intersection.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1431</span>: 		<span class="k">return</span> <span class="n">fmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">SDF</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_r = fmax(((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.L), __pyx_v_pos), ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.SDF(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.R), __pyx_v_pos));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1432</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1433</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_12Intersection_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_v_L;
  intLIST __pyx_v_R;
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1433, 0, <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Intersection.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1434</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;INTERSECTING: &quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1435</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_L = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self-&gt;__pyx_base.L, __pyx_v_pos, __pyx_v_dire);
</pre><pre class="cython line score-0">&#xA0;<span class="">1436</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1437</span>: 		<span class="k">if</span> <span class="n">L</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_L.size() == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1438</span>: 			<span class="k">return</span> <span class="n">L</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_L;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1439</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1440</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">R</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_R = ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;intersect(__pyx_v_self-&gt;__pyx_base.R, __pyx_v_pos, __pyx_v_dire);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1441</span>: 		<span class="k">if</span> <span class="n">R</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_R.size() == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1442</span>: 			<span class="k">return</span> <span class="n">R</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_R;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1443</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1444</span>: 		<span class="k">return</span> <span class="n">intIntersect</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = intIntersect(__pyx_v_L, __pyx_v_R);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1445</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1446</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_12Intersection_is_inside(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Intersection *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 1446, 0, <span class='error_goto'>__PYX_ERR(0, 1446, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Intersection.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1447</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">is_inside</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.L-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.L), __pyx_v_pos) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_2 = (((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol *)__pyx_v_self-&gt;__pyx_base.R-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.is_inside(((struct __pyx_obj_10MontyCarlo_8geometry_4main_Volume *)__pyx_v_self-&gt;__pyx_base.R), __pyx_v_pos) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L3_bool_binop_done:;
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1448</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1449</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1450</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1451</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1452</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1453</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1454</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1455</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1456</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1459</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1460</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1461</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1462</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1463</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1464</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1465</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1466</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1467</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1468</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1469</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1470</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1471</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1472</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1473</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1474</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1475</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1476</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1477</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1479</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1480</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1481</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1482</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1484</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1485</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1486</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1488</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1490</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1491</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1492</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1493</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1494</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1495</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1499</span>: <span class="c">#   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄       ▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄               ▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1500</span>: <span class="c">#  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░▌     ▐░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌             ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1501</span>: <span class="c">#  ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌ ▀▀▀▀█░█▀▀▀▀ ▐░▌░▌   ▐░▐░▌ ▀▀▀▀█░█▀▀▀▀  ▀▀▀▀█░█▀▀▀▀  ▀▀▀▀█░█▀▀▀▀  ▐░▌           ▐░▌ ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1502</span>: <span class="c">#  ▐░▌       ▐░▌▐░▌       ▐░▌     ▐░▌     ▐░▌▐░▌ ▐░▌▐░▌     ▐░▌          ▐░▌          ▐░▌       ▐░▌         ▐░▌  ▐░▌          ▐░▌          </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1503</span>: <span class="c">#  ▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌     ▐░▌     ▐░▌ ▐░▐░▌ ▐░▌     ▐░▌          ▐░▌          ▐░▌        ▐░▌       ▐░▌   ▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄▄▄ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1504</span>: <span class="c">#  ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     ▐░▌     ▐░▌  ▐░▌  ▐░▌     ▐░▌          ▐░▌          ▐░▌         ▐░▌     ▐░▌    ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1505</span>: <span class="c">#  ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀█░█▀▀      ▐░▌     ▐░▌   ▀   ▐░▌     ▐░▌          ▐░▌          ▐░▌          ▐░▌   ▐░▌     ▐░█▀▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀▀▀█░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1506</span>: <span class="c">#  ▐░▌          ▐░▌     ▐░▌       ▐░▌     ▐░▌       ▐░▌     ▐░▌          ▐░▌          ▐░▌           ▐░▌ ▐░▌      ▐░▌                    ▐░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1507</span>: <span class="c">#  ▐░▌          ▐░▌      ▐░▌  ▄▄▄▄█░█▄▄▄▄ ▐░▌       ▐░▌ ▄▄▄▄█░█▄▄▄▄      ▐░▌      ▄▄▄▄█░█▄▄▄▄        ▐░▐░▌       ▐░█▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄█░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1508</span>: <span class="c">#  ▐░▌          ▐░▌       ▐░▌▐░░░░░░░░░░░▌▐░▌       ▐░▌▐░░░░░░░░░░░▌     ▐░▌     ▐░░░░░░░░░░░▌        ▐░▌        ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1509</span>: <span class="c">#   ▀            ▀         ▀  ▀▀▀▀▀▀▀▀▀▀▀  ▀         ▀  ▀▀▀▀▀▀▀▀▀▀▀       ▀       ▀▀▀▀▀▀▀▀▀▀▀          ▀          ▀▀▀▀▀▀▀▀▀▀▀  ▀▀▀▀▀▀▀▀▀▀▀ </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1510</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1511</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">InfiniteVolume</span><span class="p">(</span><span class="n">CSGvol</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_InfiniteVolume {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_InfiniteVolume {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_InfiniteVolume *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_InfiniteVolume;

</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1512</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vaccum</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-23 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_14InfiniteVolume_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_14InfiniteVolume_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_vaccum = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vaccum,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vaccum);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1512, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vaccum = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1512, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.InfiniteVolume.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_14InfiniteVolume___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_InfiniteVolume *)__pyx_v_self), __pyx_v_vaccum);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_14InfiniteVolume___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_InfiniteVolume *__pyx_v_self, PyObject *__pyx_v_vaccum) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1512, 0, <span class='error_goto'>__PYX_ERR(0, 1512, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.InfiniteVolume.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1513</span>: 		<span class="nb">super</span><span class="p">(</span><span class="n">InfiniteVolume</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span></pre>
<pre class='cython code score-32 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_InfiniteVolume));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_InfiniteVolume));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_InfiniteVolume));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1514</span>: 		<span class="k">if</span> <span class="n">vaccum</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_vaccum); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1514, __pyx_L1_error)</span>
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1515</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">opaque</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.opaque = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1516</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1517</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1518</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_14InfiniteVolume_is_inside(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_InfiniteVolume *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 1518, 0, <span class='error_goto'>__PYX_ERR(0, 1518, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.InfiniteVolume.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1519</span>: 		<span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1520</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1521</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_14InfiniteVolume_SDF(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_InfiniteVolume *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1521, 0, <span class='error_goto'>__PYX_ERR(0, 1521, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.InfiniteVolume.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1522</span>: 		<span class="k">return</span> <span class="o">-</span><span class="n">INF</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (-NPY_INFINITY);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1523</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1524</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_14InfiniteVolume_intersect(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_InfiniteVolume *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_dire) {
  intLIST __pyx_v_result;
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1524, 0, <span class='error_goto'>__PYX_ERR(0, 1524, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.InfiniteVolume.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1525</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">result</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1526</span>: 		<span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1527</span>: 		<span class="c">#return INF</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1528</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1529</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Primitive</span><span class="p">(</span><span class="n">CSGvol</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *tr;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_CSGvol __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Primitive;

</pre><pre class="cython line score-0">&#xA0;<span class="">1530</span>: 	<span class="k">cdef</span> <span class="kt">Transform</span> <span class="nf">tr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1531</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1532</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1533</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_self) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1533, 0, <span class='error_goto'>__PYX_ERR(0, 1533, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Primitive.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1534</span>: 		<span class="nb">super</span><span class="p">(</span><span class="n">Primitive</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span></pre>
<pre class='cython code score-32 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Primitive));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1535</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tr</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Identity), ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;tr);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;tr));
  __pyx_v_self-&gt;tr = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1536</span>: </pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1537</span>: 	<span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">):</span></pre>
<pre class='cython code score-37 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_3translate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_dx = 0;
  PyObject *__pyx_v_dy = 0;
  PyObject *__pyx_v_dz = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dx,&amp;__pyx_n_s_dy,&amp;__pyx_n_s_dz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1537, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1537, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "translate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1537, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_dx = values[0];
    __pyx_v_dy = values[1];
    __pyx_v_dz = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("translate", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1537, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Primitive.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_2translate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self), __pyx_v_dx, __pyx_v_dy, __pyx_v_dz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_2translate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_self, PyObject *__pyx_v_dx, PyObject *__pyx_v_dy, PyObject *__pyx_v_dz) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("translate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("translate", __pyx_f[0], 1537, 0, <span class='error_goto'>__PYX_ERR(0, 1537, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Primitive.translate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1538</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;tr), __pyx_n_s_translate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1538, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_dx, __pyx_v_dy, __pyx_v_dz};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1538, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dx);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_dx);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dy);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dy);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_dy);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dz);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_dz);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_v_dz);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_10MontyCarlo_8geometry_3CSG_Transform))))) <span class='error_goto'>__PYX_ERR(0, 1538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;tr);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;tr));
  __pyx_v_self-&gt;tr = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1539</span>: 		<span class="c">#self.mesh.translate([dx, dy, dz])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1540</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1541</span>: 	<span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span></pre>
<pre class='cython code score-31 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_5rotate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_angle = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_axis,&amp;__pyx_n_s_angle,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_axis)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_angle)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1541, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "rotate") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1541, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_axis = values[0];
    __pyx_v_angle = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rotate", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1541, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Primitive.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_4rotate(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self), __pyx_v_axis, __pyx_v_angle);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_4rotate(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_self, PyObject *__pyx_v_axis, PyObject *__pyx_v_angle) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate", 0);
  <span class='trace'>__Pyx_TraceCall</span>("rotate", __pyx_f[0], 1541, 0, <span class='error_goto'>__PYX_ERR(0, 1541, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Primitive.rotate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1542</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;tr), __pyx_n_s_rotate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1542, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_axis, __pyx_v_angle};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1542, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_axis, __pyx_v_angle};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1542, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1542, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_axis);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_axis);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_axis);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_angle);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_angle);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_angle);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1542, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_10MontyCarlo_8geometry_3CSG_Transform))))) <span class='error_goto'>__PYX_ERR(0, 1542, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;tr);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;tr));
  __pyx_v_self-&gt;tr = ((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1543</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1544</span>: 	<span class="nd">@property</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1545</span>: 	<span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_6matrix_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_6matrix_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_6matrix___get__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_6matrix___get__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 1545, 0, <span class='error_goto'>__PYX_ERR(0, 1545, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Primitive.matrix.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1546</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">matrix</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;tr), __pyx_n_s_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1547</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1548</span>: 	<span class="nd">@property</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1549</span>: 	<span class="k">def</span> <span class="nf">inv_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_10inv_matrix_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_9Primitive_10inv_matrix_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_10inv_matrix___get__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_9Primitive_10inv_matrix___get__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 1549, 0, <span class='error_goto'>__PYX_ERR(0, 1549, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Primitive.inv_matrix.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1550</span>: 		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">inv_matrix</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;tr), __pyx_n_s_inv_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1551</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1552</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1553</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Sphere</span><span class="p">(</span><span class="n">Primitive</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Primitive __pyx_base;
  double r;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Sphere {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Primitive __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Sphere *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Sphere;

</pre><pre class="cython line score-0">&#xA0;<span class="">1554</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">r</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1555</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1556</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1557</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">r</span><span class="p">):</span></pre>
<pre class='cython code score-33 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_6Sphere_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_6Sphere_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  double __pyx_v_r;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_r,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1557, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_r = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_r == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1557, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1557, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Sphere.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6Sphere___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *)__pyx_v_self), __pyx_v_r);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_6Sphere___init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *__pyx_v_self, double __pyx_v_r) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1557, 0, <span class='error_goto'>__PYX_ERR(0, 1557, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Sphere.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1558</span>: 		<span class="nb">super</span><span class="p">(</span><span class="n">Sphere</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span></pre>
<pre class='cython code score-32 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Sphere));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Sphere));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_10MontyCarlo_8geometry_3CSG_Sphere));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1559</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;r = __pyx_v_r;
</pre><pre class="cython line score-0">&#xA0;<span class="">1560</span>: 		<span class="c">#self.mesh_gen = plt_geo.sphere(r)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1561</span>: 		<span class="c">#import pyvista as pv</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1562</span>: 		<span class="c">#self.mesh = pv.Sphere(self.r)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1563</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1564</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">_pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_6Sphere_is_inside(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v__pos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 1564, 0, <span class='error_goto'>__PYX_ERR(0, 1564, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Sphere.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1565</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">pos</span> <span class="o">=</span> <span class="n">_pos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos = __pyx_v__pos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1566</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">inv_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self-&gt;__pyx_base.tr-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;inv_pos(__pyx_v_self-&gt;__pyx_base.tr, __pyx_v_pos);
</pre><pre class="cython line score-0">&#xA0;<span class="">1567</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1568</span>: 		<span class="k">return</span> <span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((((__pyx_v_pos.x * __pyx_v_pos.x) + (__pyx_v_pos.y * __pyx_v_pos.y)) + (__pyx_v_pos.z * __pyx_v_pos.z)) &lt;= (__pyx_v_self-&gt;r * __pyx_v_self-&gt;r));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1569</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1570</span>: 	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6Sphere_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6Sphere_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6Sphere_2__repr__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6Sphere_2__repr__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__repr__", __pyx_f[0], 1570, 0, <span class='error_goto'>__PYX_ERR(0, 1570, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Sphere.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1571</span>: 		<span class="k">return</span> <span class="n">f</span><span class="s">&quot;&lt;Sphere: r = {self.r}&gt;&quot;</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_3 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Sphere_r);
  __pyx_t_2 += 13;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Sphere_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Sphere_r);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;r);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_4, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_3;
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
  __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__68);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__68);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u__68);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 3, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1572</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1573</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">_pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_6Sphere_SDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v__pos) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1573, 0, <span class='error_goto'>__PYX_ERR(0, 1573, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Sphere.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1574</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">pos</span> <span class="o">=</span> <span class="n">_pos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos = __pyx_v__pos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1575</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">inv_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self-&gt;__pyx_base.tr-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;inv_pos(__pyx_v_self-&gt;__pyx_base.tr, __pyx_v_pos);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1576</span>: 		<span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (sqrt((((__pyx_v_pos.x * __pyx_v_pos.x) + (__pyx_v_pos.y * __pyx_v_pos.y)) + (__pyx_v_pos.z * __pyx_v_pos.z))) - __pyx_v_self-&gt;r);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1577</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1578</span>: 	<span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6Sphere_5scale(PyObject *__pyx_v_self, PyObject *__pyx_v_s); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_6Sphere_5scale(PyObject *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scale (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_6Sphere_4scale(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *)__pyx_v_self), ((PyObject *)__pyx_v_s));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_6Sphere_4scale(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *__pyx_v_self, PyObject *__pyx_v_s) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scale", 0);
  <span class='trace'>__Pyx_TraceCall</span>("scale", __pyx_f[0], 1578, 0, <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Sphere.scale", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1579</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">*=</span> <span class="n">s</span></pre>
<pre class='cython code score-22 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;r);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_t_1, __pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self-&gt;r = __pyx_t_3;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1580</span>: 		<span class="k">return</span> <span class="bp">self</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_r = ((PyObject *)__pyx_v_self);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1581</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1582</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1583</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1584</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1585</span>: 	<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">_pos</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">_dire</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static intLIST __pyx_f_10MontyCarlo_8geometry_3CSG_6Sphere_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Sphere *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v__pos, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v__dire) {
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos;
  struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_dire;
  double __pyx_v_b;
  double __pyx_v_DELTA;
  intLIST __pyx_v_result;
  Interval __pyx_v_I;
  intLIST __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intersect", __pyx_f[0], 1585, 0, <span class='error_goto'>__PYX_ERR(0, 1585, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Sphere.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __Pyx_pretend_to_initialize(&amp;__pyx_r);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1586</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;INTERSECTING SPHERE&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1587</span>: 		<span class="c"># direction * origin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1588</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1589</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">pos</span> <span class="o">=</span> <span class="n">_pos</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pos = __pyx_v__pos;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1590</span>: 		<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">dire</span> <span class="o">=</span> <span class="n">_dire</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dire = __pyx_v__dire;
</pre><pre class="cython line score-0">&#xA0;<span class="">1591</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1592</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">inv_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self-&gt;__pyx_base.tr-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;inv_pos(__pyx_v_self-&gt;__pyx_base.tr, __pyx_v_pos);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1593</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="o">.</span><span class="n">inv_dire</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Transform *)__pyx_v_self-&gt;__pyx_base.tr-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;inv_dire(__pyx_v_self-&gt;__pyx_base.tr, __pyx_v_dire);
</pre><pre class="cython line score-0">&#xA0;<span class="">1594</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1595</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1596</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">b</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_b = (((__pyx_v_pos.x * __pyx_v_dire.x) + (__pyx_v_pos.y * __pyx_v_dire.y)) + (__pyx_v_pos.z * __pyx_v_dire.z));
</pre><pre class="cython line score-0">&#xA0;<span class="">1597</span>: 		<span class="c"># b*b - (|o|**2 - r**2)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1598</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">DELTA</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span></pre>
<pre class='cython code score-0 '>  __pyx_v_DELTA = (((((__pyx_v_b * __pyx_v_b) - (__pyx_v_pos.x * __pyx_v_pos.x)) - (__pyx_v_pos.y * __pyx_v_pos.y)) - (__pyx_v_pos.z * __pyx_v_pos.z)) + (__pyx_v_self-&gt;r * __pyx_v_self-&gt;r));
</pre><pre class="cython line score-0">&#xA0;<span class="">1599</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1600</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1601</span>: 		<span class="k">cdef</span> <span class="kt">Interval</span> <span class="nf">I</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1602</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1603</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;b = {b}, DELTA = {DELTA})&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1604</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1605</span>: 		<span class="k">if</span> <span class="n">DELTA</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_DELTA &lt;= 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1606</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;RETURNING EMPTY&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1607</span>: 			<span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_result;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1608</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1609</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1610</span>: 		<span class="n">DELTA</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">DELTA</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_DELTA = sqrt(__pyx_v_DELTA);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1611</span>: 		<span class="n">b</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_b = (__pyx_v_b * -1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1613</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;proposed t2 = {b + DELTA}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1614</span>: 		<span class="k">if</span> <span class="n">b</span> <span class="o">+</span> <span class="n">DELTA</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">1e-12</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_b + __pyx_v_DELTA) &gt;= -1e-12) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1615</span>: 			<span class="n">I</span><span class="o">.</span><span class="n">t2</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">DELTA</span></pre>
<pre class='cython code score-0 '>    __pyx_v_I.t2 = (__pyx_v_b + __pyx_v_DELTA);
</pre><pre class="cython line score-0">&#xA0;<span class="">1616</span>: 		<span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1617</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;RETURNING EMPTY&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1618</span>: 			<span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = __pyx_v_result;
    goto __pyx_L0;
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1619</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1620</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;proposed t1 = {b - DELTA}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1621</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1622</span>: 		<span class="k">if</span> <span class="n">b</span> <span class="o">-</span> <span class="n">DELTA</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">1e-12</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_b - __pyx_v_DELTA) &gt;= -1e-12) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1623</span>: 			<span class="n">I</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">DELTA</span></pre>
<pre class='cython code score-0 '>    __pyx_v_I.t1 = (__pyx_v_b - __pyx_v_DELTA);
</pre><pre class="cython line score-0">&#xA0;<span class="">1624</span>: 		<span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1625</span>: 			<span class="n">I</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_I.t1 = -10.0;
  }
  __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1626</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1627</span>: 		<span class="n">result</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">I</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_result.push_back(__pyx_v_I);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1628</span>: 		<span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1629</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1630</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1631</span>: <span class="c">#cdef class Box(Primitive):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1632</span>: <span class="c">#	cdef double x, y, z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1633</span>: <span class="c">#	def __init__(self, x, y, z):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1634</span>: <span class="c">#		self.x = x/2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1635</span>: <span class="c">#		self.y = y/2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1636</span>: <span class="c">#		self.z = z/2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1637</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1638</span>: <span class="c">#	cdef double SDF(self, double3 _pos):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1639</span>: <span class="c">#		cdef double3 pos = _pos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1640</span>: <span class="c">#		self.tr.inv_pos(pos)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1641</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1642</span>: <span class="c">#		pos.x = abs(pos.x) - self.x</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1643</span>: <span class="c">#		pos.y = abs(pos.y) - self.y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1644</span>: <span class="c">#		pos.z = abs(pos.z) - self.z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1645</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1646</span>: <span class="c">#		return sqrt(fmax(pos.x, 0.)**2 + fmax(pos.y, 0.)**2 + fmax(pos.z, 0.)**2) + fmin(0., fmax(pos.x, fmax(pos.y, pos.z)))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1648</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1649</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1650</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1651</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1652</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1653</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1654</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1655</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1656</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1657</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1658</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1659</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1660</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1661</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1662</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1663</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1664</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1665</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1666</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1667</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1668</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1669</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1670</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1671</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1672</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1673</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1674</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1675</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1676</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1677</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1678</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1679</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1680</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1681</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1682</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1683</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1684</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Tally</span><span class="p">(</span><span class="n">BVH</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Tally {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_BVH __pyx_base;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Tally {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_BVH __pyx_base;
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Tally *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Tally;

</pre><pre class="cython line score-0">&#xA0;<span class="">1685</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1686</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositUNIFORM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">SP</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_5Tally_depositUNIFORM(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Tally *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, CYTHON_UNUSED double __pyx_v_SP) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositUNIFORM", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositUNIFORM", __pyx_f[0], 1686, 0, <span class='error_goto'>__PYX_ERR(0, 1686, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Tally.depositUNIFORM", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1687</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;depositUNIFORM called from Tally (virtual)&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__71, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 1687, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__71 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_depositUNIFORM_called_from_Tally);<span class='error_goto'> if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 1687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__71);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__71);
</pre><pre class="cython line score-0">&#xA0;<span class="">1688</span>: 		<span class="k">import</span> <span class="nn">time</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1689</span>: 		<span class="k">print</span><span class="p">(</span><span class="s">&quot;depositUNIFORM called from Tally (virtual)&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1690</span>: 		<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">10</span><span class="n">_000</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1691</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1692</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositLOCAL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_5Tally_depositLOCAL(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Tally *__pyx_v_self, CYTHON_UNUSED struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, CYTHON_UNUSED double __pyx_v_E) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositLOCAL", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositLOCAL", __pyx_f[0], 1692, 0, <span class='error_goto'>__PYX_ERR(0, 1692, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Tally.depositLOCAL", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1693</span>: 		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;&#39;depositLOCAL&#39; called from its virtual in &#39;Volume.BVH&#39; &quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_RuntimeError, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1693, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='error_goto'>__PYX_ERR(0, 1693, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1694</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1695</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1696</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_5Tally_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_5Tally_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_5Tally___init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Tally *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_5Tally___init__(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Tally *__pyx_v_self) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1696, 0, <span class='error_goto'>__PYX_ERR(0, 1696, __pyx_L1_error)</span>);

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Tally.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1697</span>: 		<span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1698</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1699</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1700</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1701</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Z_TALLY</span><span class="p">(</span><span class="n">Tally</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY {
  struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Tally __pyx_base;
  std::vector&lt;double&gt;  bins;
  std::vector&lt;double&gt;  counts;
  std::vector&lt;double&gt;  tmp;
  struct __pyx_t_10MontyCarlo_5types_double3 last_pos;
  double L;
  double DZ;
  int Nbins;
};
/* … */
struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Z_TALLY {
  struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Tally __pyx_base;
  PyObject *(*reset)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, int __pyx_skip_dispatch);
  int (*intEVENT)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void (*boundary_crossing)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void (*deposit)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;, double);
  void (*final)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
  void (*virtual_event)(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;, double);
};
static struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_vtabptr_10MontyCarlo_8geometry_3CSG_Z_TALLY;
static CYTHON_INLINE int __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_intEVENT(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_final(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;);
static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_virtual_event(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;, double);

</pre><pre class="cython line score-0">&#xA0;<span class="">1702</span>: 	<span class="k">cdef</span> <span class="kt">vector</span>[<span class="kt">double</span>] <span class="nf">bins</span><span class="p">,</span> <span class="nf">counts</span><span class="p">,</span> <span class="nf">tmp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1703</span>: 	<span class="k">cdef</span> <span class="kt">double3</span> <span class="nf">last_pos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1704</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">L</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1705</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">DZ</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1706</span>: 	<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">Nbins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1707</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1708</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1709</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositRANDOM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">,</span> <span class="n">double</span> <span class="n">tau</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_depositRANDOM(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, double __pyx_v_E, double __pyx_v_tau) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositRANDOM", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositRANDOM", __pyx_f[0], 1709, 0, <span class='error_goto'>__PYX_ERR(0, 1709, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.depositRANDOM", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1710</span>: 		<span class="c">#print(&quot;depositing random &quot;)</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1711</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">(</span>  <span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">tau</span><span class="o">*</span><span class="n">state</span><span class="o">.</span><span class="n">genPTR</span><span class="o">.</span><span class="n">get_next_float</span><span class="p">())</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span>   <span class="p">)]</span> <span class="o">+=</span> <span class="n">E</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = (__pyx_v_state.pos.z - ((__pyx_v_state.dire.z * __pyx_v_tau) * __pyx_v_state.genPTR-&gt;get_next_float()));
  if (unlikely(__pyx_v_self-&gt;DZ == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 1711, __pyx_L1_error)</span>
  }
  __pyx_t_2 = ((int)(__pyx_t_1 / __pyx_v_self-&gt;DZ));
  (__pyx_v_self-&gt;bins[__pyx_t_2]) = ((__pyx_v_self-&gt;bins[__pyx_t_2]) + __pyx_v_E);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1712</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">E</span> <span class="o">-=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.E = (__pyx_v_state.E - __pyx_v_E);
</pre><pre class="cython line score-0">&#xA0;<span class="">1713</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1714</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1715</span>: 	<span class="k">def</span> <span class="nf">get_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_1get_bins(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_1get_bins(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_bins (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_7Z_TALLY_get_bins(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_7Z_TALLY_get_bins(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self) {
  PyObject *__pyx_v_np = NULL;
  PyObject *__pyx_v_z_axis = NULL;
  PyObject *__pyx_v_bins = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_bins", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_bins", __pyx_f[0], 1715, 0, <span class='error_goto'>__PYX_ERR(0, 1715, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Z_TALLY.get_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_np);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_axis);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bins);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1716</span>: 		<span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1716, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_np = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1717</span>: 		<span class="n">z_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span></pre>
<pre class='cython code score-54 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_np, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;Nbins);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_int_0, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_int_0, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;DZ);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_z_axis = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1718</span>: 		<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_np, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;Nbins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bins = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1719</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1720</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;Nbins;
  __pyx_t_7 = __pyx_t_5;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">1721</span>: 			<span class="c">#if self.counts[i] == 0: </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1722</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1723</span>: 				<span class="c">#continue</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1724</span>: 			<span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="c">#/self.counts[i]</span></pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;bins[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1724, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_bins, __pyx_v_i, __pyx_t_6, int, 1, __Pyx_PyInt_From_int, 0, 1, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1724, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1725</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1726</span>: 		<span class="k">return</span> <span class="n">z_axis</span><span class="p">,</span> <span class="n">bins</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z_axis);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z_axis);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_z_axis);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bins);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_bins);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_bins);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1727</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1728</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1729</span>: 	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DZ</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mf">1000</span><span class="p">):</span></pre>
<pre class='cython code score-26 '>/* Python wrapper */
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_3__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_DZ = 0;
  PyObject *__pyx_v_zmax = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_DZ,&amp;__pyx_n_s_zmax,0};
    PyObject* values[2] = {0,0};
    values[0] = ((PyObject *)__pyx_float_0_5);
    values[1] = ((PyObject *)__pyx_int_1000);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_DZ);
          if (value) { values[0] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_zmax);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_DZ = values[0];
    __pyx_v_zmax = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Z_TALLY.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_7Z_TALLY_2__init__(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *)__pyx_v_self), __pyx_v_DZ, __pyx_v_zmax);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_10MontyCarlo_8geometry_3CSG_7Z_TALLY_2__init__(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, PyObject *__pyx_v_DZ, PyObject *__pyx_v_zmax) {
  int __pyx_v_i;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 1729, 0, <span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Z_TALLY.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1730</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">DZ</span> <span class="o">=</span> <span class="n">DZ</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_DZ); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1730, __pyx_L1_error)</span>
  __pyx_v_self-&gt;DZ = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1731</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">(</span><span class="n">zmax</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span><span class="p">)</span> <span class="c"># 5 meters</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;DZ);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_zmax, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1731, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_self-&gt;Nbins = ((int)__pyx_t_4);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1732</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="o">.</span><span class="n">reserve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;bins.reserve(__pyx_v_self-&gt;Nbins);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1733</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="o">.</span><span class="n">reserve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;counts.reserve(__pyx_v_self-&gt;Nbins);
</pre><pre class="cython line score-0">&#xA0;<span class="">1734</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1735</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;Nbins;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1736</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;bins[__pyx_v_i]) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1737</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;counts[__pyx_v_i]) = 0.0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1738</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1739</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1740</span>: 	<span class="k">cpdef</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-33 '>static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_5reset(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_reset(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reset", 0);
  <span class='trace'>__Pyx_TraceCall</span>("reset", __pyx_f[0], 1740, 0, <span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_reset);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1740, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_5reset)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Z_TALLY.reset", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_5reset(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_10MontyCarlo_8geometry_3CSG_7Z_TALLY_5reset(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reset (wrapper)", 0);
  __pyx_r = __pyx_pf_10MontyCarlo_8geometry_3CSG_7Z_TALLY_4reset(((struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10MontyCarlo_8geometry_3CSG_7Z_TALLY_4reset(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reset", 0);
  <span class='trace'>__Pyx_TraceCall</span>("reset (wrapper)", __pyx_f[0], 1740, 0, <span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_reset(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("MontyCarlo.geometry.CSG.Z_TALLY.reset", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1741</span>: 		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nbins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;Nbins;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1742</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;bins[__pyx_v_i]) = 0.0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1743</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1744</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1745</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">depositLOCAL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">,</span> <span class="n">double</span> <span class="n">E</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_depositLOCAL(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos, double __pyx_v_E) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("depositLOCAL", 0);
  <span class='trace'>__Pyx_TraceCall</span>("depositLOCAL", __pyx_f[0], 1745, 0, <span class='error_goto'>__PYX_ERR(0, 1745, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.depositLOCAL", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1746</span>: 		<span class="k">if</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_pos.z &lt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1747</span>: 			<span class="k">print</span><span class="p">(</span><span class="s">&quot;OUT OF BOUNDS, LOCAL DEPOSIT: z =&quot;</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_pos.z);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_OUT_OF_BOUNDS_LOCAL_DEPOSIT_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_OUT_OF_BOUNDS_LOCAL_DEPOSIT_z);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_s_OUT_OF_BOUNDS_LOCAL_DEPOSIT_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3);
    __pyx_t_2 = 0;
    __pyx_t_3 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1748</span>: 			<span class="k">return</span></pre>
<pre class='cython code score-0 '>    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1749</span>: 		<span class="c">#if pos.y**2 + pos.x**2 &gt; 1: return </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1750</span>: 		<span class="c">#if self.id == state.id:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1751</span>: 		<span class="c">#	self.bins[&lt;int&gt; (state.pos.z/self.DZ)] += E</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1752</span>: 		<span class="c">#	return</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1753</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1754</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1755</span>: 		<span class="c">#self.id = state.id</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1756</span>: 		<span class="c">#self.counts[&lt;int&gt; (pos.z/self.DZ)] += 1</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1757</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">E</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_self-&gt;DZ == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 1757, __pyx_L1_error)</span>
  }
  __pyx_t_5 = ((int)(__pyx_v_pos.z / __pyx_v_self-&gt;DZ));
  (__pyx_v_self-&gt;bins[__pyx_t_5]) = ((__pyx_v_self-&gt;bins[__pyx_t_5]) + __pyx_v_E);
</pre><pre class="cython line score-0">&#xA0;<span class="">1758</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1759</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1760</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1761</span>: 		<span class="c">#self.counts[&lt;int&gt; (pos.z/self.DZ)] += 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1762</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1763</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">SP</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_move(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, double __pyx_v_SP) {
  int __pyx_v_case;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("move", 0);
  <span class='trace'>__Pyx_TraceCall</span>("move", __pyx_f[0], 1763, 0, <span class='error_goto'>__PYX_ERR(0, 1763, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.move", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1764</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1765</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s"> ----MOVING PARTICLE----&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1766</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;CURRENT_POSITION: {state.pos}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1767</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Is inside current region? {(&lt;V&gt; state.current_region).is_inside(state.pos)}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1768</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1769</span>: 			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nws</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1770</span>: 				<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;is_inside[{i}] = {(&lt;V&gt; self.ws[i]).is_inside(state.pos)}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1771</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1772</span>: 		<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="s">&quot;STARTING EVENT LOOP&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1773</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1774</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1775</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1776</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1777</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1778</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1779</span>: 		<span class="c">#if state.pos.z &lt; -0.01:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1780</span>: 			<span class="c">#import time</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1781</span>: 			<span class="c">#time.sleep(10000)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1782</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1783</span>: 		<span class="k">if</span> <span class="n">SP</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_pos</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pos</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_SP != 0.0) != 0);
  if (__pyx_t_1) {
    __pyx_t_2 = __pyx_v_state.pos;
    __pyx_v_self-&gt;last_pos = __pyx_t_2;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1784</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1785</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_state.L;
  __pyx_v_self-&gt;L = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">1786</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1787</span>: 		<span class="k">while</span> <span class="bp">True</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
</pre><pre class="cython line score-0">&#xA0;<span class="">1788</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;The safest distance is {state.pos.z}cm | Physics proposed {state.L}cm &quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1789</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1790</span>: 			<span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">&gt;</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_state.pos.z &gt; __pyx_v_state.L) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1791</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1792</span>: 				<span class="k">if</span> <span class="n">SP</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_SP != 0.0) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1793</span>: 					<span class="bp">self</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">SP</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Z_TALLY *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;deposit(__pyx_v_self, __pyx_v_state, __pyx_v_SP);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1794</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>      __pyx_v_self-&gt;__pyx_base.__pyx_base.cache = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1795</span>: 				<span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>      __pyx_r = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1796</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1797</span>: 			<span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">&lt;</span> <span class="n">eps</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_state.pos.z &lt; __pyx_v_10MontyCarlo_8geometry_3CSG_eps) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1798</span>: 				<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Intersection Event&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1799</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1800</span>: 				<span class="n">case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intEVENT</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_case = __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_intEVENT(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0">&#xA0;<span class="">1801</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1802</span>: 				<span class="k">if</span> <span class="n">SP</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_SP != 0.0) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1803</span>: 					<span class="bp">self</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">SP</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Z_TALLY *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;deposit(__pyx_v_self, __pyx_v_state, __pyx_v_SP);
</pre><pre class="cython line score-0">&#xA0;<span class="">1804</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1805</span>: 				<span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span> <span class="c"># boundary crossing</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_case == 2) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1806</span>: 					<span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>        __pyx_r = 1;
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1807</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1808</span>: 				<span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span> <span class="c"># final displacement</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_case == 0) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1809</span>: 					<span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>        __pyx_v_self-&gt;__pyx_base.__pyx_base.cache = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1810</span>: 					<span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>        __pyx_r = 0;
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1811</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1812</span>: 			<span class="cp">IF</span> <span class="n">DEBUG_MODE</span><span class="p">:</span> <span class="nb">input</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;Virtual Event&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1813</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">virtual_event</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_virtual_event(__pyx_v_self, __pyx_v_state, __pyx_v_state.pos.z);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1814</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1815</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1816</span>: 	<span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">intEVENT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE int __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_intEVENT(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  double __pyx_v_cos;
  double __pyx_v_t;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intEVENT", 0);
  <span class='trace'>__Pyx_TraceCall</span>("intEVENT", __pyx_f[0], 1816, 0, <span class='error_goto'>__PYX_ERR(0, 1816, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.intEVENT", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1817</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;intEVENT&quot;</span><span class="p">,</span> <span class="n">f</span><span class="s">&quot;sdf = {state.pos.z}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1818</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;cache = {self.cache}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1819</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;direction:&quot;</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1820</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.cache != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1821</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1822</span>: 			<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1823</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1824</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cos</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_state.dire.z;
  __pyx_v_cos = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">1825</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1826</span>: 		<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0001</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((fabs(__pyx_v_cos) &gt; 0.0001) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1827</span>: 			<span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">/</span> <span class="n">cos</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = (-__pyx_v_state.pos.z);
    if (unlikely(__pyx_v_cos == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 1827, __pyx_L1_error)</span>
    }
    __pyx_v_t = (__pyx_t_2 / __pyx_v_cos);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1828</span>: 			<span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_state.L &lt; __pyx_v_t) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1829</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1830</span>: 				<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>      __pyx_r = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1831</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1832</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">virtual_event</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_virtual_event(__pyx_v_self, __pyx_v_state, __pyx_v_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1833</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">boundary_crossing</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_10MontyCarlo_8geometry_3CSG_Z_TALLY *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;boundary_crossing(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1834</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.__pyx_base.cache = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1835</span>: 			<span class="n">state</span><span class="o">.</span><span class="n">current_region</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer</span></pre>
<pre class='cython code score-0 '>    __pyx_v_state.current_region = ((void *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.outer);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1836</span>: 			<span class="k">return</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 2;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1837</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_final(__pyx_v_self, __pyx_v_state);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1838</span>: 		<span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1839</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1840</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1841</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">boundary_crossing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_boundary_crossing(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("boundary_crossing", 0);
  <span class='trace'>__Pyx_TraceCall</span>("boundary_crossing", __pyx_f[0], 1841, 0, <span class='error_goto'>__PYX_ERR(0, 1841, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.boundary_crossing", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1842</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">current_region</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.current_region = ((void *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.outer);
</pre><pre class="cython line score-0">&#xA0;<span class="">1843</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1844</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1845</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">SP</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_deposit(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, double __pyx_v_SP) {
  int __pyx_v_i0;
  int __pyx_v_i1;
  double __pyx_v_dz;
  double __pyx_v_cos;
  double __pyx_v_dE;
  long __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("deposit", 0);
  <span class='trace'>__Pyx_TraceCall</span>("deposit", __pyx_f[0], 1845, 0, <span class='error_goto'>__PYX_ERR(0, 1845, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.deposit", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1846</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1847</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1848</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i0</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_pos</span><span class="o">.</span><span class="n">z</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_self-&gt;DZ == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 1848, __pyx_L1_error)</span>
  }
  __pyx_v_i0 = ((int)(__pyx_v_self-&gt;last_pos.z / __pyx_v_self-&gt;DZ));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1849</span>: 		<span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i1</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span> <span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_self-&gt;DZ == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 1849, __pyx_L1_error)</span>
  }
  __pyx_v_i1 = ((int)(__pyx_v_state.pos.z / __pyx_v_self-&gt;DZ));
</pre><pre class="cython line score-0">&#xA0;<span class="">1850</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1851</span>: 		<span class="k">if</span> <span class="n">i0</span> <span class="o">&lt;</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">i1</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_i0 &lt; 0) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_i1 &lt; 0) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1852</span>: 			<span class="k">print</span><span class="p">(</span><span class="s">&quot;OUT OF BOUNDS:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_pos</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span></pre>
<pre class='cython code score-12 '>    __pyx_t_3 = __pyx_convert__to_py_struct____pyx_t_10MontyCarlo_5types_double3(__pyx_v_self-&gt;last_pos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1852, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = __pyx_convert__to_py_struct____pyx_t_10MontyCarlo_5types_double3(__pyx_v_state.pos);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1852, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1852, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_OUT_OF_BOUNDS);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_OUT_OF_BOUNDS);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_kp_s_OUT_OF_BOUNDS);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_4);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1852, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1853</span>: 			<span class="k">return</span></pre>
<pre class='cython code score-0 '>    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1854</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1855</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span> <span class="n">i1</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1856</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1857</span>: 		<span class="k">if</span> <span class="n">i0</span> <span class="o">==</span> <span class="n">i1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_i0 == __pyx_v_i1) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1858</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i0</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">-</span><span class="n">state</span><span class="o">.</span><span class="n">L</span><span class="p">)</span><span class="o">*</span><span class="n">SP</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_i0;
    (__pyx_v_self-&gt;bins[__pyx_t_6]) = ((__pyx_v_self-&gt;bins[__pyx_t_6]) + ((__pyx_v_self-&gt;L - __pyx_v_state.L) * __pyx_v_SP));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1859</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">i0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_i0;
    (__pyx_v_self-&gt;counts[__pyx_t_6]) = ((__pyx_v_self-&gt;counts[__pyx_t_6]) + 1.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1860</span>: 			<span class="k">return</span></pre>
<pre class='cython code score-0 '>    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1861</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1862</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1863</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1864</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1865</span>: 		<span class="n">dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_pos</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">i0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dz = (__pyx_v_self-&gt;last_pos.z - (__pyx_v_i0 * __pyx_v_self-&gt;DZ));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1866</span>: 		<span class="n">cos</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_cos = fabs(__pyx_v_state.dire.z);
</pre><pre class="cython line score-0">&#xA0;<span class="">1867</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1868</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">SP</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span> <span class="o">-</span> <span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span></pre>
<pre class='cython code score-5 '>  __pyx_t_6 = __pyx_v_i0;
  __pyx_t_7 = (__pyx_v_SP * (__pyx_v_self-&gt;DZ - __pyx_v_dz));
  if (unlikely(__pyx_v_cos == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 1868, __pyx_L1_error)</span>
  }
  (__pyx_v_self-&gt;bins[__pyx_t_6]) = ((__pyx_v_self-&gt;bins[__pyx_t_6]) + (__pyx_t_7 / __pyx_v_cos));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1869</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">i0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_i0;
  (__pyx_v_self-&gt;counts[__pyx_t_6]) = ((__pyx_v_self-&gt;counts[__pyx_t_6]) + 1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1870</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1871</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">SP</span><span class="o">*</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">-</span> <span class="n">i1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">DZ</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span></pre>
<pre class='cython code score-5 '>  __pyx_t_6 = __pyx_v_i1;
  __pyx_t_7 = (__pyx_v_SP * (__pyx_v_state.pos.z - (__pyx_v_i1 * __pyx_v_self-&gt;DZ)));
  if (unlikely(__pyx_v_cos == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>
  }
  (__pyx_v_self-&gt;bins[__pyx_t_6]) = ((__pyx_v_self-&gt;bins[__pyx_t_6]) + (__pyx_t_7 / __pyx_v_cos));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1872</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_i1;
  (__pyx_v_self-&gt;counts[__pyx_t_6]) = ((__pyx_v_self-&gt;counts[__pyx_t_6]) + 1.0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1873</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1874</span>: 		<span class="c">#else: # change indexes around</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1875</span>: 		<span class="c">#	dz = self.last_pos.z - i1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1876</span>: 		<span class="c">#	cos = abs(state.dire.z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1877</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1878</span>: 		<span class="c">#	self.bins[i1] += (self.DZ - dz)/cos*SP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1879</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1880</span>: 		<span class="c">#	self.bins[i0] += (state.pos.z - i0)/cos*SP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1881</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1882</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1883</span>: 		<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i1</span> <span class="o">-</span> <span class="n">i0</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = abs((__pyx_v_i1 - __pyx_v_i0));<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 1883, __pyx_L1_error)</span>
  __pyx_t_1 = ((__pyx_t_6 == 1) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1884</span>: 			<span class="k">return</span></pre>
<pre class='cython code score-0 '>    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1885</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1886</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DZ</span><span class="o">*</span><span class="n">SP</span><span class="o">/</span><span class="n">cos</span></pre>
<pre class='cython code score-5 '>  __pyx_t_7 = (__pyx_v_self-&gt;DZ * __pyx_v_SP);
  if (unlikely(__pyx_v_cos == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 1886, __pyx_L1_error)</span>
  }
  __pyx_v_dE = (__pyx_t_7 / __pyx_v_cos);
</pre><pre class="cython line score-0">&#xA0;<span class="">1887</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1888</span>: 		<span class="k">if</span> <span class="n">i0</span> <span class="o">&lt;</span> <span class="n">i1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_i0 &lt; __pyx_v_i1) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L8;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1889</span>: 			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">i1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_i1;
    __pyx_t_8 = __pyx_t_6;
    for (__pyx_t_9 = (__pyx_v_i0 + 1); __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1890</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dE</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_i;
      (__pyx_v_self-&gt;bins[__pyx_t_10]) = ((__pyx_v_self-&gt;bins[__pyx_t_10]) + __pyx_v_dE);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1891</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_i;
      (__pyx_v_self-&gt;counts[__pyx_t_10]) = ((__pyx_v_self-&gt;counts[__pyx_t_10]) + 1.0);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1892</span>: 		<span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1893</span>: 			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i1</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">i0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_6 = __pyx_v_i0;
    __pyx_t_8 = __pyx_t_6;
    for (__pyx_t_9 = (__pyx_v_i1 + 1); __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1894</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dE</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_i;
      (__pyx_v_self-&gt;bins[__pyx_t_10]) = ((__pyx_v_self-&gt;bins[__pyx_t_10]) + __pyx_v_dE);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1895</span>: 				<span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_i;
      (__pyx_v_self-&gt;counts[__pyx_t_10]) = ((__pyx_v_self-&gt;counts[__pyx_t_10]) + 1.0);
    }
  }
  __pyx_L8:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1896</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1897</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1898</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1899</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">SDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_SDF(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 __pyx_v_pos) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("SDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("SDF", __pyx_f[0], 1899, 0, <span class='error_goto'>__PYX_ERR(0, 1899, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.SDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1900</span>: 		<span class="k">return</span> <span class="o">-</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (-__pyx_v_pos.z);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1901</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1902</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1903</span>: 	<span class="k">cdef</span> <span class="kt">void</span> <span class="nf">localSDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_localSDF(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("localSDF", 0);
  <span class='trace'>__Pyx_TraceCall</span>("localSDF", __pyx_f[0], 1903, 0, <span class='error_goto'>__PYX_ERR(0, 1903, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.localSDF", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1904</span>: 		<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1905</span>: <span class="sd">		JOB OF &#39;localSDF&#39;:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1906</span>: <span class="sd">			(1) Set attribute .sdf equal to a *safe distance*</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1907</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1908</span>: <span class="sd">		note: &#39;safe distance&#39; does not imply the result of a signed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1909</span>: <span class="sd">			   distance function (despite the name I gave it).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1910</span>: <span class="sd">			   The rest of the code will work as long as this distance can</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1911</span>: <span class="sd">			   be travelled without hitting some other surface.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1912</span>: <span class="sd">		&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1913</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.cache != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1914</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="n">INF</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.__pyx_base.sdf = NPY_INFINITY;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1915</span>: 			<span class="k">return</span></pre>
<pre class='cython code score-0 '>    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1916</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1917</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="o">-</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.__pyx_base.sdf = (-__pyx_v_state.pos.z);
</pre><pre class="cython line score-0">&#xA0;<span class="">1918</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1919</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1920</span>: 	<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">main_intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_main_intersect(struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  double __pyx_v_cos;
  intLIST __pyx_v_crosses;
  Interval __pyx_v_I;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_intersect", 0);
  <span class='trace'>__Pyx_TraceCall</span>("main_intersect", __pyx_f[0], 1920, 0, <span class='error_goto'>__PYX_ERR(0, 1920, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.main_intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1921</span>: 		<span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1922</span>: <span class="sd">		JOB OF &#39;main_intersect&#39;:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1923</span>: <span class="sd">			(1) if previously marked as cache:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1924</span>: <span class="sd">					PROVIDE DISTANCE TO THE NEXT CACHED INTERSECTION</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1925</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1926</span>: <span class="sd">			(2) if not marked as cache:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1927</span>: <span class="sd">				(1.1) Intersect ray with self</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1928</span>: <span class="sd">				(1.2) collect intersections into an &#39;intLIST&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1929</span>: <span class="sd">				(1.3) create and store an &#39;intIerator&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1930</span>: <span class="sd">				(1.4) return distance to the next intersection</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1931</span>: <span class="sd">		&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1932</span>: 		<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;main_intersect&quot;</span><span class="p">,</span> <span class="n">f</span><span class="s">&quot;cache = {self.cache}&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1933</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1934</span>: 		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.cache != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1935</span>: 			<span class="c"># cache implies previous boundary crossing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1936</span>: 			<span class="c"># after a BC, only way forward is to infinity</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1937</span>: 			<span class="k">return</span> <span class="n">INF</span></pre>
<pre class='cython code score-0 '>    __pyx_r = NPY_INFINITY;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1938</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1939</span>: 		<span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.__pyx_base.cache = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1940</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1941</span>: 		<span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cos</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_state.dire.z;
  __pyx_v_cos = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">1942</span>: 		<span class="k">cdef</span> <span class="kt">intLIST</span> <span class="nf">crosses</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1943</span>: 		<span class="k">cdef</span> <span class="kt">Interval</span> <span class="nf">I</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1944</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1945</span>: 		<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((fabs(__pyx_v_cos) &gt; 0.0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1946</span>: 			<span class="n">I</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10</span></pre>
<pre class='cython code score-0 '>    __pyx_v_I.t1 = -10.0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1947</span>: 			<span class="n">I</span><span class="o">.</span><span class="n">t2</span> <span class="o">=</span> <span class="o">-</span><span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">/</span> <span class="n">cos</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = (-__pyx_v_state.pos.z);
    if (unlikely(__pyx_v_cos == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 1947, __pyx_L1_error)</span>
    }
    __pyx_v_I.t2 = (__pyx_t_2 / __pyx_v_cos);
</pre><pre class="cython line score-0">&#xA0;<span class="">1948</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">t2</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1949</span>: 			<span class="n">crosses</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">I</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_crosses.push_back(__pyx_v_I);
</pre><pre class="cython line score-0">&#xA0;<span class="">1950</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1951</span>: 			<span class="bp">self</span><span class="o">.</span><span class="n">cross</span> <span class="o">=</span> <span class="n">intIterator</span><span class="p">(</span><span class="n">crosses</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;__pyx_base.__pyx_base.cross = intIterator(__pyx_v_crosses);
</pre><pre class="cython line score-0">&#xA0;<span class="">1952</span>: 			<span class="cp">IF</span> <span class="n">VERBOSE_TALLY</span><span class="p">:</span> <span class="k">print</span><span class="p">(</span><span class="s">&quot;next_crosS:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">current</span><span class="p">())</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1953</span>: 			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross</span><span class="o">.</span><span class="n">current</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_self-&gt;__pyx_base.__pyx_base.cross.current();
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1954</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1955</span>: 		<span class="k">return</span> <span class="n">INF</span></pre>
<pre class='cython code score-0 '>  __pyx_r = NPY_INFINITY;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1956</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1957</span>: 	<span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">final</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_final(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("final", 0);
  <span class='trace'>__Pyx_TraceCall</span>("final", __pyx_f[0], 1957, 0, <span class='error_goto'>__PYX_ERR(0, 1957, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.final", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1958</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1959</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1960</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1961</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">last_displacement</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_state.L;
  __pyx_v_state.last_displacement = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1962</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1963</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.x = (__pyx_v_state.pos.x + (__pyx_v_state.dire.x * __pyx_v_state.L));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1964</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.y = (__pyx_v_state.pos.y + (__pyx_v_state.dire.y * __pyx_v_state.L));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1965</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">state</span><span class="o">.</span><span class="n">L</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.z = (__pyx_v_state.pos.z + (__pyx_v_state.dire.z * __pyx_v_state.L));
</pre><pre class="cython line score-0">&#xA0;<span class="">1966</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1967</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.L = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1968</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1969</span>: 	<span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double3</span><span class="o">&amp;</span> <span class="n">pos</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static int __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_is_inside(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_5types_double3 &amp;__pyx_v_pos) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_inside", 0);
  <span class='trace'>__Pyx_TraceCall</span>("is_inside", __pyx_f[0], 1969, 0, <span class='error_goto'>__PYX_ERR(0, 1969, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.is_inside", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1970</span>: 		<span class="k">return</span> <span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_pos.z &gt;= 0.0);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1971</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1972</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1973</span>: 	<span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">virtual_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">STATE</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">,</span> <span class="n">double</span> <span class="n">dr</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE void __pyx_f_10MontyCarlo_8geometry_3CSG_7Z_TALLY_virtual_event(CYTHON_UNUSED struct __pyx_obj_10MontyCarlo_8geometry_3CSG_Z_TALLY *__pyx_v_self, struct __pyx_t_10MontyCarlo_9particles_8particle_STATE &amp;__pyx_v_state, double __pyx_v_dr) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("virtual_event", 0);
  <span class='trace'>__Pyx_TraceCall</span>("virtual_event", __pyx_f[0], 1973, 0, <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("MontyCarlo.geometry.CSG.Z_TALLY.virtual_event", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1974</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1975</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">x</span><span class="o">*</span><span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.x = (__pyx_v_state.pos.x + (__pyx_v_state.dire.x * __pyx_v_dr));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1976</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.y = (__pyx_v_state.pos.y + (__pyx_v_state.dire.y * __pyx_v_dr));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1977</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span> <span class="o">+=</span> <span class="n">state</span><span class="o">.</span><span class="n">dire</span><span class="o">.</span><span class="n">z</span><span class="o">*</span><span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.pos.z = (__pyx_v_state.pos.z + (__pyx_v_state.dire.z * __pyx_v_dr));
</pre><pre class="cython line score-0">&#xA0;<span class="">1978</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1979</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">last_displacement</span> <span class="o">=</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.last_displacement = __pyx_v_dr;
</pre><pre class="cython line score-0">&#xA0;<span class="">1980</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1981</span>: 		<span class="n">state</span><span class="o">.</span><span class="n">L</span> <span class="o">-=</span> <span class="n">dr</span></pre>
<pre class='cython code score-0 '>  __pyx_v_state.L = (__pyx_v_state.L - __pyx_v_dr);
</pre></div></body></html>
